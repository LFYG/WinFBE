<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta http-equiv='X-UA-Compatible' content='IE=edge' />
  <meta http-equiv='MSThemeCompatible' content='Yes'>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CBSTR Class</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">@font-face {font-family: octicons-link;src: url(data:font/woff;charset=utf-8;base64,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) format('woff');}body {-webkit-text-size-adjust: 100%;text-size-adjust: 100%;color: #333;font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size: 16px;line-height: 1.6;word-wrap: break-word;width: 728px;max-width: 99%;box-sizing: border-box;padding: 30px 30px 8rem 30px;margin-left: auto;margin-right: auto;}body a {background-color: transparent;}body a:active,body a:hover {outline: 0;}body strong {font-weight: bold;}body h1 {font-size: 2em;margin: 0.67em 0;}body img {border: 0;}body hr {box-sizing: content-box;height: 0;}body pre {overflow: auto;}body code,body kbd,body pre {font-family: monospace, monospace;font-size: 1em;}body input {color: inherit;font: inherit;margin: 0;}body html input[disabled] {cursor: default;}body input {line-height: normal;}body input[type="checkbox"] {box-sizing: border-box;padding: 0;}body table {border-collapse: collapse;border-spacing: 0;}body td,body th {padding: 0;}body * {box-sizing: border-box;}body input {font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";}body a {color: #4078c0;text-decoration: none;}body a:hover,body a:active {text-decoration: underline;}body hr {height: 0;margin: 15px 0;overflow: hidden;background: transparent;border: 0;border-bottom: 1px solid #ddd;}body hr:before {display: table;content: "";}body hr:after {display: table;clear: both;content: "";}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 15px;margin-bottom: 15px;line-height: 1.1;}body h1 {font-size: 30px;}body h2 {font-size: 21px;}body h3 {font-size: 16px;}body h4 {font-size: 14px;}body h5 {font-size: 12px;}body h6 {font-size: 11px;}body blockquote {margin: 0;}body ul,body ol {padding: 0;margin-top: 0;margin-bottom: 0;}body ol ol,body ul ol {list-style-type: lower-roman;}body ul ul ol,body ul ol ol,body ol ul ol,body ol ol ol {list-style-type: lower-alpha;}body dd {margin-left: 0;}body code {font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;font-size: 12px;}body pre {margin-top: 0;margin-bottom: 0;font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;}body .select::-ms-expand {opacity: 0;}body .octicon {font: normal normal normal 16px/1 octicons-link;display: inline-block;text-decoration: none;text-rendering: auto;-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}body .octicon-link:before {content: '\f05c';}body:before {display: table;content: "";}body:after {display: table;clear: both;content: "";}body>*:first-child {margin-top: 0 !important;}body>*:last-child {margin-bottom: 0 !important;}body a:not([href]) {color: inherit;text-decoration: none;}body .anchor {display: inline-block;padding-right: 2px;margin-left: -18px;}body .anchor:focus {outline: none;}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 1em;margin-bottom: 16px;font-weight: bold;line-height: 1.4;}body h1 .octicon-link,body h2 .octicon-link,body h3 .octicon-link,body h4 .octicon-link,body h5 .octicon-link,body h6 .octicon-link {color: #000;vertical-align: middle;visibility: hidden;}body h1:hover .anchor,body h2:hover .anchor,body h3:hover .anchor,body h4:hover .anchor,body h5:hover .anchor,body h6:hover .anchor {text-decoration: none;}body h1:hover .anchor .octicon-link,body h2:hover .anchor .octicon-link,body h3:hover .anchor .octicon-link,body h4:hover .anchor .octicon-link,body h5:hover .anchor .octicon-link,body h6:hover .anchor .octicon-link {visibility: visible;}body h1 {padding-bottom: 0.3em;font-size: 1.75em;line-height: 1.2;}body h1 .anchor {line-height: 1;}body h2 {padding-bottom: 0.3em;font-size: 1.5em;line-height: 1.225;}body h2 .anchor {line-height: 1;}body h3 {font-size: 1.25em;line-height: 1.43;}body h3 .anchor {line-height: 1.2;}body h4 {font-size: 1em;}body h4 .anchor {line-height: 1.2;}body h5 {font-size: 1em;}body h5 .anchor {line-height: 1.1;}body h6 {font-size: 1em;color: #777;}body h6 .anchor {line-height: 1.1;}body p,body blockquote,body ul,body ol,body dl,body table,body pre {margin-top: 0;margin-bottom: 16px;}body hr {height: 4px;padding: 0;margin: 16px 0;background-color: #e7e7e7;border: 0 none;}body ul,body ol {padding-left: 2em;}body ul ul,body ul ol,body ol ol,body ol ul {margin-top: 0;margin-bottom: 0;}body li>p {margin-top: 16px;}body dl {padding: 0;}body dl dt {padding: 0;margin-top: 16px;font-size: 1em;font-style: italic;font-weight: bold;}body dl dd {padding: 0 16px;margin-bottom: 16px;}body blockquote {padding: 0 15px;color: #777;border-left: 4px solid #ddd;}body blockquote>:first-child {margin-top: 0;}body blockquote>:last-child {margin-bottom: 0;}body table {display: block;width: 100%;overflow: auto;word-break: normal;word-break: keep-all;}body table th {font-weight: bold;}body table th,body table td {padding: 6px 13px;border: 1px solid #ddd;}body table tr {background-color: #fff;border-top: 1px solid #ccc;}body table tr:nth-child(2n) {background-color: #f8f8f8;}body img {max-width: 100%;box-sizing: content-box;background-color: #fff;}body code {padding: 0;padding-top: 0;padding-bottom: 0;margin: 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}body code:before,body code:after {letter-spacing: -0.2em;content: "\00a0";}body pre>code {padding: 0;margin: 0;font-size: 100%;word-break: normal;white-space: pre;background: transparent;border: 0;}body .highlight {margin-bottom: 16px;}body .highlight pre,body pre {padding: 16px;overflow: auto;font-size: 85%;line-height: 1.45;background-color: #f7f7f7;border-radius: 3px;}body .highlight pre {margin-bottom: 0;word-break: normal;}body pre {word-wrap: normal;}body pre code {display: inline;max-width: initial;padding: 0;margin: 0;overflow: initial;line-height: inherit;word-wrap: normal;background-color: transparent;border: 0;}body pre code:before,body pre code:after {content: normal;}body kbd {display: inline-block;padding: 3px 5px;font-size: 11px;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .pl-c {color: #969896;}body .pl-c1,body .pl-s .pl-v {color: #0086b3;}body .pl-e,body .pl-en {color: #795da3;}body .pl-s .pl-s1,body .pl-smi {color: #333;}body .pl-ent {color: #63a35c;}body .pl-k {color: #a71d5d;}body .pl-pds,body .pl-s,body .pl-s .pl-pse .pl-s1,body .pl-sr,body .pl-sr .pl-cce,body .pl-sr .pl-sra,body .pl-sr .pl-sre {color: #183691;}body .pl-v {color: #ed6a43;}body .pl-id {color: #b52a1d;}body .pl-ii {background-color: #b52a1d;color: #f8f8f8;}body .pl-sr .pl-cce {color: #63a35c;font-weight: bold;}body .pl-ml {color: #693a17;}body .pl-mh,body .pl-mh .pl-en,body .pl-ms {color: #1d3e81;font-weight: bold;}body .pl-mq {color: #008080;}body .pl-mi {color: #333;font-style: italic;}body .pl-mb {color: #333;font-weight: bold;}body .pl-md {background-color: #ffecec;color: #bd2c00;}body .pl-mi1 {background-color: #eaffea;color: #55a532;}body .pl-mdr {color: #795da3;font-weight: bold;}body .pl-mo {color: #1d3e81;}body kbd {display: inline-block;padding: 3px 5px;font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .task-list-item {list-style-type: none;}body .task-list-item+.task-list-item {margin-top: 3px;}body .task-list-item input {margin: 0 0.35em 0.25em -1.6em;vertical-align: middle;}body :checked+.radio-label {z-index: 1;position: relative;border-color: #4078c0;}</style>
  
    
  
</head>
<body>
<h1 id="cbstr-class">CBSTR Class</h1>
<p>The <strong>CBSTR</strong> class implements a dynamic unicode null terminated string. Free Basic has a dynamic string data type (STRING) and a fixed length unicode data type (WSTRING), but it lacks a dynamic unicode string. <strong>CBSTR</strong> behaves as if it was a native data type, working directly with the intrinsic Free Basic string functions and operators.</p>
<p><strong>Include file</strong>: CWSTR.INC.</p>
<p>Quirks:</p>
<ul>
<li>MID as a function: Something like MID(cbs, 2) doesn't work with languages such Russian and Chinese. Using MID(**cbs, 2), MID(cbs.wstr, 2) or cbs.MidChars(2) works.</li>
<li>MID as a statement: Something like MID(cbs, 2, 1) = &quot;x&quot; compiles but does not change the contents of the dynamic unicode string. MID(**cbs, 2, 1) = &quot;x&quot; works.</li>
<li>SELECT CASE: Something like SELECT CASE LEFT(cbs, 2) does not compile; we have to use SELECT CASE LEFT(**cbs, 2).</li>
</ul>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#Constructors">Constructors</a></td>
<td>Initialize the class with the specified value.</td>
</tr>
<tr class="even">
<td><a href="#Operator*">Operator *</a></td>
<td>One * returns the address of the CBSTR buffer.<br> Two ** returns the address of the start of the string data.</td>
</tr>
<tr class="odd">
<td><a href="#bptr">bptr</a></td>
<td>Returns the underlying BSTR pointer.</td>
</tr>
<tr class="even">
<td><a href="#sptr">sptr</a></td>
<td>Returns the address of the string data. Same as **.</td>
</tr>
<tr class="odd">
<td><a href="#vptr">vptr</a></td>
<td>Frees the underlying BSTR and returns the BSTR pointer.</td>
</tr>
<tr class="even">
<td><a href="#wstr">wstr</a></td>
<td>Returns the string data. Same as **.</td>
</tr>
<tr class="odd">
<td><a href="#Operator&amp;">Operator &amp;</a></td>
<td>Concatenates strings.</td>
</tr>
<tr class="even">
<td><a href="#Operator+=">Operator +=</a></td>
<td>Appends a string to the CBSTR.</td>
</tr>
<tr class="odd">
<td><a href="#Operator&amp;=">Operator &amp;=</a></td>
<td>Appends a string to the CBSTR.</td>
</tr>
<tr class="even">
<td><a href="#OperatorLet">Operator Let</a></td>
<td>Assigns a string to the CBSTR. It implements the = operator.</td>
</tr>
<tr class="odd">
<td><a href="#OperatorCast">Operator Cast</a></td>
<td>Returns a pointer to the CBSTR buffer or the string data.<br>Casting is automatic. You don't have to call this operator.</td>
</tr>
<tr class="even">
<td><a href="#wstr">wstr</a></td>
<td>Returns the string data. Same as **.</td>
</tr>
<tr class="odd">
<td><a href="#wchar">wchar</a></td>
<td>Returns the string data as a new unicode string allocated with CoTaskMemAlloc.</td>
</tr>
<tr class="even">
<td><a href="#Utf8">Utf8</a></td>
<td>Converts from UTF8 to Unicode and from Unicode to UTF8.</td>
</tr>
<tr class="odd">
<td><a href="#Attach">Attach</a></td>
<td>Attaches a BSTR to the CBSTR class.</td>
</tr>
<tr class="even">
<td><a href="#Detach">Detach</a></td>
<td>Detaches the underlying BSTR from the CBSTR class and returns it as the result of the function.</td>
</tr>
<tr class="odd">
<td><a href="#Append">Append</a></td>
<td>Appends a string to the CBSTR.</td>
</tr>
<tr class="even">
<td><a href="#Clear">Clear</a></td>
<td>Frees the underlying BSTR.</td>
</tr>
<tr class="odd">
<td><a href="#Empty">Empty</a></td>
<td>Frees the underlying BSTR.</td>
</tr>
<tr class="even">
<td><a href="#Left">Left</a></td>
<td>Returns the leftmost substring of the string. Same as LEFT.</td>
</tr>
<tr class="odd">
<td><a href="#Right">Right</a></td>
<td>Returns the rightmost substring of the string. Same as RIGHT.</td>
</tr>
<tr class="even">
<td><a href="#LeftChars">LeftChars</a></td>
<td>Returns the leftmost substring of the string. Same as Left.</td>
</tr>
<tr class="odd">
<td><a href="#MidChars">MidChars</a></td>
<td>Returns a substring of the string. Same as Mid.</td>
</tr>
<tr class="even">
<td><a href="#RightChars">RightChars</a></td>
<td>Returns the rightmost substring of the string. Same as Right.</td>
</tr>
<tr class="odd">
<td><a href="#Val">Val</a></td>
<td>Converts the string to a floating point number (DOUBLE).</td>
</tr>
<tr class="even">
<td><a href="#ValDouble">ValDouble</a></td>
<td>Converts the string to a floating point number (DOUBLE).</td>
</tr>
<tr class="odd">
<td><a href="#ValInt">ValInt</a></td>
<td>Converts the string to a signed 32-bit integer (LONG).</td>
</tr>
<tr class="even">
<td><a href="#ValLong">ValLong</a></td>
<td>Converts the string to a signed 32-bit integer (LONG).</td>
</tr>
<tr class="odd">
<td><a href="#ValLongInt">ValLongInt</a></td>
<td>Converts the string to a signed 64-bit integer (LONGINT).</td>
</tr>
<tr class="even">
<td><a href="#Value">Value</a></td>
<td>Converts the string to a floating point number (DOUBLE).</td>
</tr>
<tr class="odd">
<td><a href="#ValUInt">ValUInt</a></td>
<td>Converts the string to a 32.bit unsigned integer (ULONG).</td>
</tr>
<tr class="even">
<td><a href="#ValULong">ValULong</a></td>
<td>Converts the string to a 32-bit unsigned integer (ULONG).</td>
</tr>
<tr class="odd">
<td><a href="#ValULongInt">ValULongInt</a></td>
<td>Converts the string to a 64-bit unsigned integer (ULONGINT).</td>
</tr>
</tbody>
</table>
<h1 id="constructors"><a name="Constructors"></a>Constructors</h1>
<p>Initialize the class with the specified value.</p>
<pre><code>CONSTRUCTOR CBStr
CONSTRUCTOR CBStr (BYREF wszStr AS CONST WSTRING = &quot;&quot;)
CONSTRUCTOR CBStr (BYREF cws AS CWSTR)
CONSTRUCTOR CBStr (BYREF cbs AS CBSTR)
CONSTRUCTOR CBStr (BYREF ansiStr AS STRING, BYVAL nCodePage AS UINT = 0)
CONSTRUCTOR (BYVAL n AS LONGINT)
CONSTRUCTOR (BYVAL n AS DOUBLE)
CONSTRUCTOR (BYREF bstrHandle AS AFX_BSTR = NULL, BYVAL fAttach AS LONG = TRUE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>wszStr</em></td>
<td>A WSTRING.</td>
</tr>
<tr class="even">
<td><em>cws</em></td>
<td>A CWSTR.</td>
</tr>
<tr class="odd">
<td><em>cbs</em></td>
<td>A CBSTR.</td>
</tr>
<tr class="even">
<td><em>ansiStr</em></td>
<td>An ansi string or string literal.</td>
</tr>
<tr class="odd">
<td><em>nCodePage</em></td>
<td>The code page to be used for ansi to unicode conversions.</td>
</tr>
<tr class="even">
<td><em>n</em></td>
<td>A number.</td>
</tr>
<tr class="odd">
<td><em>bstrHandle</em></td>
<td>A handle to a BSTR..</td>
</tr>
<tr class="even">
<td><em>fAttach</em></td>
<td>TRUE = Attaches the BSTR handle to the class. It will be released when the class is destroyed; therefore, don't free the passed handle. FALSE = The contents of the passed BSTR are copied..</td>
</tr>
</tbody>
</table>
<p>For a list of code pages see: <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd317756(v=vs.85).aspx">Code Page Identifiers</a></p>
<h1 id="operators">Operators</h1>
<h2 id="operator-*"><a name="Operator*"></a>Operator *</h2>
<p>Deferences the CBSTR.<br>One * returns the address of the underlying BSTR pointer.<br>Two ** returns the address of the start of the string data.</p>
<pre><code>OPERATOR * (BYREF cbs AS CBSTR) AS AFX_BSTR
</code></pre>
<h2 id="bptr"><a name="bptr"></a>bptr</h2>
<p>Returns the underlying BSTR pointer.</p>
<pre><code>FUNCTION bptr () BYREF AS AFX_BSTR
</code></pre>
<h2 id="sptr"><a name="sptr"></a>sptr</h2>
<p>Returns the address of the CBSTR string data (same as **)</p>
<pre><code>FUNCTION sptr () AS WSTRING PTR
</code></pre>
<h2 id="vptr"><a name="vptr"></a>vptr</h2>
<p>Frees the underlying BSTR and returns the BSTR pointer.</p>
<pre><code>FUNCTION vptr () AS AFX_BSTR PTR
</code></pre>
<p>Must be used to pass the underlying BSTR to an OUT BYVAL BSTR PTR parameter. If we pass a CBSTR to a function with an OUT BSTR parameter without first freeing it we will have a memory leak.</p>
<h2 id="wstr"><a name="wstr"></a>wstr</h2>
<p>Returns the string data. Same as **.</p>
<pre><code>FUNCTION wstr () BYREF AS CONST WSTRING
</code></pre>
<h2 id="operator-&amp;"><a name="Operator&amp;"></a>Operator &amp;</h2>
<p>Concatenates strings.</p>
<pre><code>OPERATOR &amp; (BYREF cbs1 AS CBSTR, BYREF cbs2 AS CBSTR) AS CBSTR
</code></pre>
<h2 id="operator-+="><a name="Operator+="></a>Operator +=</h2>
<p>Appends a string to the CBSTR.</p>
<pre><code>OPERATOR += (BYREF wszStr AS CONST WSTRING)
OPERATOR += (BYREF cws AS CWStr)
OPERATOR += (BYREF cbs AS CBStr)
OPERATOR += (BYREF ansiStr AS STRING)
</code></pre>
<h2 id="operator-&amp;="><a name="Operator&amp;="></a>Operator &amp;=</h2>
<p>Appends a string to the CBSTR.</p>
<pre><code>OPERATOR &amp;= (BYREF wszStr AS CONST WSTRING)
OPERATOR &amp;= (BYREF cws AS CWStr)
OPERATOR &amp;= (BYREF cbs AS CBStr)
OPERATOR &amp;= (BYREF ansiStr AS STRING)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>wszStr</em></td>
<td>A WSTRING.</td>
</tr>
<tr class="even">
<td><em>cws</em></td>
<td>A CWSTR.</td>
</tr>
<tr class="odd">
<td><em>cbs</em></td>
<td>A CBSTR.</td>
</tr>
<tr class="even">
<td><em>ansiStr</em></td>
<td>An ansi string or string literal.</td>
</tr>
</tbody>
</table>
<h2 id="operator-let"><a name="OperatorLet"></a>Operator Let</h2>
<p>Assigns a string to the CBSTR.</p>
<pre><code>OPERATOR LET (BYREF wszStr AS CONST WSTRING)
OPERATOR LET (BYREF cws AS CWStr)
OPERATOR LET (BYREF cbs AS CBStr)
OPERATOR LEY (BYREF ansiStr AS STRING)
OPERATOR LET (BYVAL n AS LONGINT)
OPERATOR LET (BYVAL n AS DOUBLE)
OPERATOR LET (BYREF bstrHandle AS AFX_BSTR)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>wszStr</em></td>
<td>A WSTRING.</td>
</tr>
<tr class="even">
<td><em>cws</em></td>
<td>A CWSTR.</td>
</tr>
<tr class="odd">
<td><em>cbs</em></td>
<td>A CBSTR.</td>
</tr>
<tr class="even">
<td><em>ansiStr</em></td>
<td>An ansi string or string literal.</td>
</tr>
<tr class="odd">
<td><em>n</em></td>
<td>A number.</td>
</tr>
<tr class="even">
<td><em>bstrHandle</em></td>
<td>A handle to a BSTR. Don't free it, because it will be attached.</td>
</tr>
</tbody>
</table>
<h1 id="casting-and-conversions">Casting and Conversions</h1>
<h2 id="operator-cast"><a name="OperatorCast"></a>Operator Cast</h2>
<p>Return a pointer to the underlying BSTR or the string data. These operators aren't called directly.</p>
<pre><code>OPERATOR CAST () BYREF AS CONST WSTRING
OPERATOR CAST () AS ANY PTR
</code></pre>
<h2 id="wchar"><a name="wchar"></a>wchar</h2>
<p>Returns the string data as a new unicode string allocated with CoTaskMemAlloc. Useful when we need to pass a pointer to a null terminated wide string to a function or method that will release it. If we pass a WSTRING it will GPF. If the length of the input string is 0, CoTaskMemAlloc allocates a zero-length item and returns a valid pointer to that item. If there is insufficient memory available, CoTaskMemAlloc returns NULL.</p>
<pre><code>FUNCTION wchar () AS WSTRING PTR
</code></pre>
<h2 id="utf8"><a name="Utf8"></a>Utf8</h2>
<p>Converts from UTF8 to Unicode and from Unicode to UTF8.</p>
<pre><code>PROPERTY Utf8() AS STRING
PROPERTY Utf8 (BYREF utf8String AS STRING)
</code></pre>
<h1 id="methods">Methods</h1>
<h2 id="attach"><a name="Attach"></a>Attach</h2>
<p>Attaches a BSTR to the CBSTR class.</p>
<pre><code>SUB Attach (BYVAL pbstrSrc AS AFX_BSTR)
</code></pre>
<h2 id="detach"><a name="Detach"></a>Detach</h2>
<p>Detaches the underlying BSTR from the CBSTR class and returns it as the result of the function. The returned pointer must be freed by SysFreeString.</p>
<pre><code>FUNCTION Detach () AS AFX_BSTR
</code></pre>
<p>This method frees the <em>m_bstr</em> member of the CBSTR class and returns it as the result of the function. Because it no longer belongs to the class, it must be freed by SysFreeString.</p>
<h2 id="append"><a name="Append"></a>Append</h2>
<p>Appends a string to the CBSTR.</p>
<pre><code>SUB Append (BYREF wszStr AS CONST WSTRING)
</code></pre>
<p><em>Remark</em>: The string can be a literal or a FB STRING, a WSTRING, a CWSTR or a CBSTR variable.</p>
<h2 id="clear"><a name="Clear"></a>Clear</h2>
<p>Frees the underlying BSTR.</p>
<pre><code>SUB Clear
</code></pre>
<h2 id="empty"><a name="Empty"></a>Empty</h2>
<p>Frees the underlying BSTR.</p>
<pre><code>SUB Empty
</code></pre>
<h2 id="left"><a name="Left"></a>Left</h2>
<p>Returns the leftmost substring of the string.</p>
<pre><code>FUNCTION Left OVERLOAD (BYREF cws AS CBSTR, BYVAL nChars AS INTEGER) AS CBSTR
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>cbs</em></td>
<td>The source CBSTR.</td>
</tr>
<tr class="even">
<td><em>nChars</em></td>
<td>The number of characters to return from the source string.</td>
</tr>
</tbody>
</table>
<h2 id="right"><a name="Right"></a>Right</h2>
<p>Returns the rightmost substring of the string.</p>
<pre><code>FUNCTION Right OVERLOAD (BYREF cbs AS CBSTR, BYVAL nChars AS INTEGER) AS CBSTR
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>cbs</em></td>
<td>The source CBSTR.</td>
</tr>
<tr class="even">
<td><em>nChars</em></td>
<td>The substring length, in characters.</td>
</tr>
</tbody>
</table>
<h2 id="leftchars"><a name="LeftChars"></a>LeftChars</h2>
<p>Returns the leftmost substring of the string.</p>
<pre><code>FUNCTION LeftChars (BYVAL nChars AS LONG) AS CBSTR
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nChars</em></td>
<td>The number of characters to return from the source string.</td>
</tr>
</tbody>
</table>
<h2 id="midchars"><a name="MidChars"></a>MidChars</h2>
<p>Returns a substring of the string.</p>
<pre><code>MidChars (BYVAL nStart AS LONG, BYVAL nChars AS LONG = 0) AS CBSTR
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nStart</em></td>
<td>The start position in CBSTR of the substring. The first character starts at position 1.</td>
</tr>
<tr class="even">
<td><em>nChars</em></td>
<td>The substring length, in characters. If nChars &lt; 0 or nChars &gt;= length of the CBSTR then all of the remaining characters are returned.</td>
</tr>
</tbody>
</table>
<p>If CBSTR is empty then the null string (&quot;&quot;) is returned. If <em>nStart</em> &lt;= 0 then the null string (&quot;&quot;) is returned.</p>
<h2 id="rightchars"><a name="RightChars"></a>RightChars</h2>
<p>Returns the rightmost substring of the string.</p>
<pre><code>FUNCTION RightChars (BYVAL nChars AS LONG) AS CBSTR
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nChars</em></td>
<td>The substring length, in characters.</td>
</tr>
</tbody>
</table>
<h2 id="val"><a name="Val"></a>Val</h2>
<p>Converts the string to a floating point number (DOUBLE).</p>
<pre><code>FUNCTION Val OVERLOAD (BYREF cbs AS CBSTR) AS DOUBLE
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>cbs</em></td>
<td>The source CBSTR.</td>
</tr>
</tbody>
</table>
<h2 id="valdouble"><a name="ValDouble"></a>ValDouble</h2>
<p>Converts the string to a floating point number (DOUBLE).</p>
<pre><code>FUNCTION ValDouble () AS DOUBLE
</code></pre>
<h2 id="valint"><a name="ValInt"></a>ValInt</h2>
<p>Converts the string to a signed 32-bit integer (LONG).</p>
<pre><code>FUNCTION ValInt () AS LONG
</code></pre>
<h2 id="vallong"><a name="ValLong"></a>ValLong</h2>
<p>Converts the string to a signed 32-bit integer (LONG).</p>
<pre><code>FUNCTION ValLong () AS LONG
</code></pre>
<h2 id="vallongint"><a name="ValLongInt"></a>ValLongInt</h2>
<p>Converts the string to a signed 64-bit integer (LONGINT).</p>
<pre><code>FUNCTION ValLongInt () AS LONGINT
</code></pre>
<h2 id="value"><a name="Value"></a>Value</h2>
<p>Converts the string to a floating point number (DOUBLE).</p>
<pre><code>FUNCTION Value () AS DOUBLE
</code></pre>
<h2 id="valuint"><a name="ValUInt"></a>ValUInt</h2>
<p>Converts the string to a 32.bit unsigned integer (ULONG).</p>
<pre><code>FUNCTION ValUInt () AS ULONG
</code></pre>
<h2 id="valulong"><a name="ValULong"></a>ValULong</h2>
<p>Converts the string to a 32-bit unsigned integer (ULONG).</p>
<pre><code>FUNCTION ValULong () AS ULONG
</code></pre>
<h2 id="valulongint"><a name="ValULongInt"></a>ValULongInt</h2>
<p>Converts the string to a 64-bit unsigned integer (ULONGINT).</p>
<pre><code>FUNCTION ValULongInt () AS ULONGINT
</code></pre>
</body>
</html>

