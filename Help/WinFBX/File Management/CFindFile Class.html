<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta http-equiv='X-UA-Compatible' content='IE=edge' />
  <meta http-equiv='MSThemeCompatible' content='Yes'>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CFindFile Class</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">@font-face {font-family: octicons-link;src: url(data:font/woff;charset=utf-8;base64,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) format('woff');}body {-webkit-text-size-adjust: 100%;text-size-adjust: 100%;color: #333;font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size: 16px;line-height: 1.6;word-wrap: break-word;width: 728px;max-width: 99%;box-sizing: border-box;padding: 30px 30px 8rem 30px;margin-left: auto;margin-right: auto;}body a {background-color: transparent;}body a:active,body a:hover {outline: 0;}body strong {font-weight: bold;}body h1 {font-size: 2em;margin: 0.67em 0;}body img {border: 0;}body hr {box-sizing: content-box;height: 0;}body pre {overflow: auto;}body code,body kbd,body pre {font-family: monospace, monospace;font-size: 1em;}body input {color: inherit;font: inherit;margin: 0;}body html input[disabled] {cursor: default;}body input {line-height: normal;}body input[type="checkbox"] {box-sizing: border-box;padding: 0;}body table {border-collapse: collapse;border-spacing: 0;}body td,body th {padding: 0;}body * {box-sizing: border-box;}body input {font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";}body a {color: #4078c0;text-decoration: none;}body a:hover,body a:active {text-decoration: underline;}body hr {height: 0;margin: 15px 0;overflow: hidden;background: transparent;border: 0;border-bottom: 1px solid #ddd;}body hr:before {display: table;content: "";}body hr:after {display: table;clear: both;content: "";}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 15px;margin-bottom: 15px;line-height: 1.1;}body h1 {font-size: 30px;}body h2 {font-size: 21px;}body h3 {font-size: 16px;}body h4 {font-size: 14px;}body h5 {font-size: 12px;}body h6 {font-size: 11px;}body blockquote {margin: 0;}body ul,body ol {padding: 0;margin-top: 0;margin-bottom: 0;}body ol ol,body ul ol {list-style-type: lower-roman;}body ul ul ol,body ul ol ol,body ol ul ol,body ol ol ol {list-style-type: lower-alpha;}body dd {margin-left: 0;}body code {font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;font-size: 12px;}body pre {margin-top: 0;margin-bottom: 0;font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;}body .select::-ms-expand {opacity: 0;}body .octicon {font: normal normal normal 16px/1 octicons-link;display: inline-block;text-decoration: none;text-rendering: auto;-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}body .octicon-link:before {content: '\f05c';}body:before {display: table;content: "";}body:after {display: table;clear: both;content: "";}body>*:first-child {margin-top: 0 !important;}body>*:last-child {margin-bottom: 0 !important;}body a:not([href]) {color: inherit;text-decoration: none;}body .anchor {display: inline-block;padding-right: 2px;margin-left: -18px;}body .anchor:focus {outline: none;}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 1em;margin-bottom: 16px;font-weight: bold;line-height: 1.4;}body h1 .octicon-link,body h2 .octicon-link,body h3 .octicon-link,body h4 .octicon-link,body h5 .octicon-link,body h6 .octicon-link {color: #000;vertical-align: middle;visibility: hidden;}body h1:hover .anchor,body h2:hover .anchor,body h3:hover .anchor,body h4:hover .anchor,body h5:hover .anchor,body h6:hover .anchor {text-decoration: none;}body h1:hover .anchor .octicon-link,body h2:hover .anchor .octicon-link,body h3:hover .anchor .octicon-link,body h4:hover .anchor .octicon-link,body h5:hover .anchor .octicon-link,body h6:hover .anchor .octicon-link {visibility: visible;}body h1 {padding-bottom: 0.3em;font-size: 1.75em;line-height: 1.2;}body h1 .anchor {line-height: 1;}body h2 {padding-bottom: 0.3em;font-size: 1.5em;line-height: 1.225;}body h2 .anchor {line-height: 1;}body h3 {font-size: 1.25em;line-height: 1.43;}body h3 .anchor {line-height: 1.2;}body h4 {font-size: 1em;}body h4 .anchor {line-height: 1.2;}body h5 {font-size: 1em;}body h5 .anchor {line-height: 1.1;}body h6 {font-size: 1em;color: #777;}body h6 .anchor {line-height: 1.1;}body p,body blockquote,body ul,body ol,body dl,body table,body pre {margin-top: 0;margin-bottom: 16px;}body hr {height: 4px;padding: 0;margin: 16px 0;background-color: #e7e7e7;border: 0 none;}body ul,body ol {padding-left: 2em;}body ul ul,body ul ol,body ol ol,body ol ul {margin-top: 0;margin-bottom: 0;}body li>p {margin-top: 16px;}body dl {padding: 0;}body dl dt {padding: 0;margin-top: 16px;font-size: 1em;font-style: italic;font-weight: bold;}body dl dd {padding: 0 16px;margin-bottom: 16px;}body blockquote {padding: 0 15px;color: #777;border-left: 4px solid #ddd;}body blockquote>:first-child {margin-top: 0;}body blockquote>:last-child {margin-bottom: 0;}body table {display: block;width: 100%;overflow: auto;word-break: normal;word-break: keep-all;}body table th {font-weight: bold;}body table th,body table td {padding: 6px 13px;border: 1px solid #ddd;}body table tr {background-color: #fff;border-top: 1px solid #ccc;}body table tr:nth-child(2n) {background-color: #f8f8f8;}body img {max-width: 100%;box-sizing: content-box;background-color: #fff;}body code {padding: 0;padding-top: 0;padding-bottom: 0;margin: 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}body code:before,body code:after {letter-spacing: -0.2em;content: "\00a0";}body pre>code {padding: 0;margin: 0;font-size: 100%;word-break: normal;white-space: pre;background: transparent;border: 0;}body .highlight {margin-bottom: 16px;}body .highlight pre,body pre {padding: 16px;overflow: auto;font-size: 85%;line-height: 1.45;background-color: #f7f7f7;border-radius: 3px;}body .highlight pre {margin-bottom: 0;word-break: normal;}body pre {word-wrap: normal;}body pre code {display: inline;max-width: initial;padding: 0;margin: 0;overflow: initial;line-height: inherit;word-wrap: normal;background-color: transparent;border: 0;}body pre code:before,body pre code:after {content: normal;}body kbd {display: inline-block;padding: 3px 5px;font-size: 11px;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .pl-c {color: #969896;}body .pl-c1,body .pl-s .pl-v {color: #0086b3;}body .pl-e,body .pl-en {color: #795da3;}body .pl-s .pl-s1,body .pl-smi {color: #333;}body .pl-ent {color: #63a35c;}body .pl-k {color: #a71d5d;}body .pl-pds,body .pl-s,body .pl-s .pl-pse .pl-s1,body .pl-sr,body .pl-sr .pl-cce,body .pl-sr .pl-sra,body .pl-sr .pl-sre {color: #183691;}body .pl-v {color: #ed6a43;}body .pl-id {color: #b52a1d;}body .pl-ii {background-color: #b52a1d;color: #f8f8f8;}body .pl-sr .pl-cce {color: #63a35c;font-weight: bold;}body .pl-ml {color: #693a17;}body .pl-mh,body .pl-mh .pl-en,body .pl-ms {color: #1d3e81;font-weight: bold;}body .pl-mq {color: #008080;}body .pl-mi {color: #333;font-style: italic;}body .pl-mb {color: #333;font-weight: bold;}body .pl-md {background-color: #ffecec;color: #bd2c00;}body .pl-mi1 {background-color: #eaffea;color: #55a532;}body .pl-mdr {color: #795da3;font-weight: bold;}body .pl-mo {color: #1d3e81;}body kbd {display: inline-block;padding: 3px 5px;font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .task-list-item {list-style-type: none;}body .task-list-item+.task-list-item {margin-top: 3px;}body .task-list-item input {margin: 0 0.35em 0.25em -1.6em;vertical-align: middle;}body :checked+.radio-label {z-index: 1;position: relative;border-color: #4078c0;}</style>
  
    
  
</head>
<body>
<h1 id="cfindfile-class">CFindFile Class</h1>
<p>Wraps the <strong>FindFirstFileW</strong>, <strong>FindNext</strong> and <strong>FindCLose</strong> API functions to perform file searches and retrieve information about the files found, offering an alternative to Free Basic's <strong>DIR</strong> function that does not work with unicode.</p>
<p>The <strong>FindFile</strong> method opens a search handle and returns information about the first file that the file system finds with a name that matches the specified pattern. This may or may not be the first file or directory that appears in a directory-listing application (such as the dir command) when given the same file name string pattern. This is because <strong>FindFirstFileW</strong> does no sorting of the search results. When the search is finished, call the <strong>FindClose</strong> method.</p>
<p>The following list identifies some other search characteristics:</p>
<ul>
<li>The search is performed strictly on the name of the file, not on any attributes such as a date or a file type.</li>
<li>The search includes the long and short file names.</li>
<li>An attempt to open a search with a trailing backslash always fails.</li>
<li>Passing an invalid string, NULL, or empty string for the <em>wszFileSpec</em> parameter is not a valid use of this function. Results in this case are undefined.</li>
</ul>
<p>You cannot use a trailing backslash \ in the <em>wszFileSpec</em> parameter for <strong>FindFile</strong>, therefore it may not be obvious how to search root directories.</p>
<ul>
<li>To examine files in a root directory, you can use &quot;C:*&quot;. Note: Prepending the string &quot;\?&quot; does not allow access to the root directory.</li>
<li>On network shares, you can use an <em>wszFileSpec</em> in the form of the following: &quot;\Server\Share*&quot;. However, you cannot use an <em>wszFileSpec</em> that points to the share itself; for example, &quot;\Server\Share&quot; is not valid.</li>
<li>To examine a directory that is not a root directory, use the path to that directory, without a trailing backslash. For example, an argument of &quot;C:\Windows&quot; returns information about the directory &quot;C:\Windows&quot;, not about a directory or file in &quot;C:\Windows&quot;. To examine the files and directories in &quot;C:\Windows&quot;, use an <em>wszFileSpec</em> of &quot;C:\Windows*&quot;.</li>
</ul>
<p><strong>Include file</strong>: CFindFile.inc</p>
<h3 id="methods">Methods</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#Close">Close</a></td>
<td>Ends the search, resets the context and releases all resources.</td>
</tr>
<tr class="even">
<td><a href="#CreationTime">CreationTime</a></td>
<td>Returns the time, in local time format, the file was created.</td>
</tr>
<tr class="odd">
<td><a href="#FileAttributes">FileAttributes</a></td>
<td>Returns the attributes of the last found file.</td>
</tr>
<tr class="even">
<td><a href="#FileExt">FileExt</a></td>
<td>Returns the extesion of the found file.</td>
</tr>
<tr class="odd">
<td><a href="#FileName">FileName</a></td>
<td>Returns the name of the found file.</td>
</tr>
<tr class="even">
<td><a href="#FileNameX">FileNameX</a></td>
<td>Returns the name and extension of the found file.</td>
</tr>
<tr class="odd">
<td><a href="#FilePath">FilePath</a></td>
<td>Returns the full path of the found file.</td>
</tr>
<tr class="even">
<td><a href="#FileSize">FileSize</a></td>
<td>Returns the size of the found file, in bytes.</td>
</tr>
<tr class="odd">
<td><a href="#FileURL">FileURL</a></td>
<td>Returns the file URL.</td>
</tr>
<tr class="even">
<td><a href="#FindFile">FindFile</a></td>
<td>Opens a file search.</td>
</tr>
<tr class="odd">
<td><a href="#FindNext">FindNext</a></td>
<td>Searches the next file.</td>
</tr>
<tr class="even">
<td><a href="#IsCompressedFile">IsCompressedFile</a></td>
<td>Checks if the found file is a compressed file.</td>
</tr>
<tr class="odd">
<td><a href="#IsDots">IsDots</a></td>
<td>Call this method to test for the current directory and parent directory markers while iterating through files.</td>
</tr>
<tr class="even">
<td><a href="#IsEncryptedFile">IsEncryptedFile</a></td>
<td>Checks if the found file is an encrypted file.</td>
</tr>
<tr class="odd">
<td><a href="#IsFile">IsFile</a></td>
<td>Checks if the found file is a file and not a folder.</td>
</tr>
<tr class="even">
<td><a href="#IsFolder">IsFolder</a></td>
<td>Checks if the found file is a folder.</td>
</tr>
<tr class="odd">
<td><a href="#IsHiddenFile">IsHiddenFile</a></td>
<td>Checks if the found file is a hidden file.</td>
</tr>
<tr class="even">
<td><a href="#IsNormalFile">IsNormalFile</a></td>
<td>Checks if the found file is a normal file.</td>
</tr>
<tr class="odd">
<td><a href="#IsNotContentIndexedFile">IsNotContentIndexedFile</a></td>
<td>Checks if the found file is not to be indexed by the content indexing service..</td>
</tr>
<tr class="even">
<td><a href="#IsOffLineFile">IsOffLineFile</a></td>
<td>Checks if the found file is not available immediately.</td>
</tr>
<tr class="odd">
<td><a href="#IsReadOnlyFile">IsReadOnlyFile</a></td>
<td>Checks if the found file is a read only file.</td>
</tr>
<tr class="even">
<td><a href="#IsReparsePointFile">IsReparsePointFile</a></td>
<td>Checks if the found file is is file or directory that has an associated reparse point, or a file that is a symbolic link.</td>
</tr>
<tr class="odd">
<td><a href="#IsSparseFile">IsSparseFile</a></td>
<td>Checks if the found file is a sparse file.</td>
</tr>
<tr class="even">
<td><a href="#IsSystemFile">IsSystemFile</a></td>
<td>Checks if the found file is a system file.</td>
</tr>
<tr class="odd">
<td><a href="#IsTemporaryFile">IsTemporaryFile</a></td>
<td>Checks if the found file is a temporary file.</td>
</tr>
<tr class="even">
<td><a href="#LastAccessTime">LastAccessTime</a></td>
<td>Returns the time the file was last accessed, in local time format.</td>
</tr>
<tr class="odd">
<td><a href="#LastWriteTime">LastWriteTime</a></td>
<td>Returns the time the file was written to, truncated, or overwritten, in local time format.</td>
</tr>
<tr class="even">
<td><a href="#MatchesMask">MatchesMask</a></td>
<td>Tests the file attributes on the found file.</td>
</tr>
<tr class="odd">
<td><a href="#Root">Root</a></td>
<td>Returns the root of the found file.</td>
</tr>
<tr class="even">
<td><a href="#ShortFileName">ShortFileName</a></td>
<td>Returns an alternative name for the file. This name is in the classic 8.3 file name format.</td>
</tr>
</tbody>
</table>
<h1 id="close"><a name="Close"></a>Close</h1>
<p>Call this method to end the search, reset the context, and release all resources. After calling <strong>Close</strong>, you do not have to create a new <strong>CFindFile</strong> instance before calling <strong>FindFile</strong> to begin a new search.</p>
<pre><code>SUB Close
</code></pre>
<h1 id="creationtime"><a name="CreationTime"></a>CreationTime</h1>
<p>Call this method to get the time, in local time format, the file was created.</p>
<pre><code>FUNCTION CreationTime () AS FILETIME
</code></pre>
<h1 id="fileattributes"><a name="FileAttributes"></a>FileAttributes</h1>
<p>Call this method to get the time, in local time format, the file was created.</p>
<pre><code>FUNCTION FileAttributes () AS DWORD
</code></pre>
<h4 id="file-attribute-constants">File Attribute Constants</h4>
<p>File attributes are metadata values stored by the file system on disk and are used by the system and are available to developers via various file I/O APIs.</p>
<table>
<thead>
<tr class="header">
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FILE_ATTRIBUTE_ARCHIVE</td>
<td>A file or directory that is an archive file or directory. Applications typically use this attribute to mark files for backup or removal.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_DEVICE</td>
<td>This value is reserved for system use.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_DIRECTORY</td>
<td>The handle that identifies a directory.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_ENCRYPTED</td>
<td>A file or directory that is encrypted. For a file, all data streams in the file are encrypted. For a directory, encryption is the default for newly created files and subdirectories.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_HIDDEN</td>
<td>The file or directory is hidden. It is not included in an ordinary directory listing.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_INTEGRITY_STREAM</td>
<td>The directory or user data stream is configured with integrity (only supported on ReFS volumes). It is not included in an ordinary directory listing. The integrity setting persists with the file if it's renamed. If a file is copied the destination file will have integrity set if either the source file or destination directory have integrity set. Windows Server 2008 R2, Windows 7, Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP: This flag is not supported until Windows Server 2012.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_NORMAL</td>
<td>A file that does not have other attributes set. This attribute is valid only when used alone.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_NOT_CONTENT_INDEXED</td>
<td>The file or directory is not to be indexed by the content indexing service.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_NO_SCRUB_DATA</td>
<td>The user data stream not to be read by the background data integrity scanner (AKA scrubber). When set on a directory it only provides inheritance. This flag is only supported on Storage Spaces and ReFS volumes. It is not included in an ordinary directory listing. Windows Server 2008 R2, Windows 7, Windows Server 2008, Windows Vista, Windows Server 2003, and Windows XP: This flag is not supported until Windows 8 and Windows Server 2012.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_OFFLINE</td>
<td>The data of a file is not available immediately. This attribute indicates that the file data is physically moved to offline storage. This attribute is used by Remote Storage, which is the hierarchical storage management software. Applications should not arbitrarily change this attribute.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_READONLY</td>
<td>A file that is read-only. Applications can read the file, but cannot write to it or delete it. This attribute is not honored on directories. For more information, see You cannot view or change the Read-only or the System attributes of folders in Windows Server 2003, in Windows XP, in Windows Vista or in Windows 7.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_REPARSE_POINT</td>
<td>A file or directory that has an associated reparse point, or a file that is a symbolic link.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_SPARSE_FILE</td>
<td>A file that is a sparse file.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_SYSTEM</td>
<td>A file or directory that the operating system uses a part of, or uses exclusively.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_TEMPORARY</td>
<td>A file that is being used for temporary storage. File systems avoid writing data back to mass storage if sufficient cache memory is available, because typically, an application deletes a temporary file after the handle is closed. In that scenario, the system can entirely avoid writing the data. Otherwise, the data is written after the handle is closed.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_VIRTUAL</td>
<td>This value is reserved for system use.</td>
</tr>
</tbody>
</table>
<h4 id="remarks">Remarks</h4>
<p>The FILE_ATTRIBUTE_SPARSE_FILE attribute on the file is set if any of the streams of the file have ever been sparse.</p>
<h1 id="fileext"><a name="FileExt"></a>FileExt</h1>
<p>Returns the extension of the most-recently-found file.</p>
<pre><code>FUNCTION FileExt () AS CWSTR
</code></pre>
<h1 id="filename"><a name="FileName"></a>FileName</h1>
<p>Returns the name of the most-recently-found file, excluding the extension.</p>
<pre><code>FUNCTION FileName () AS CWSTR
</code></pre>
<h1 id="filenamex"><a name="FileNameX"></a>FileNameX</h1>
<p>Returns the name of the most-recently-found file, including the extension.</p>
<pre><code>FUNCTION FileNameX () AS CWSTR
</code></pre>
<h1 id="filepath"><a name="FilePath"></a>FilePath</h1>
<p>Call this method to get the entire path of the found file.</p>
<pre><code>FUNCTION FilePath () AS CWSTR
</code></pre>
<h1 id="filesize"><a name="FileSize"></a>FileSize</h1>
<p>Call this method to get the size of the found file, in bytes.</p>
<pre><code>FUNCTION FileSize  () AS ULONGLONG
</code></pre>
<h1 id="fileurl"><a name="FileURL"></a>FileURL</h1>
<p>Call this member function to retrieve the URL of the file.</p>
<pre><code>FUNCTION FileURL () AS CWSTR
</code></pre>
<h4 id="remark">Remark</h4>
<p><strong>FileURL</strong> is similar to the member function <strong>FilePath</strong>, except that it returns the URL in the form file://path. For example, calling FileURL to get the complete URL for myfile.txt returns the URL file://c:\myhtml\myfile.txt.</p>
<h1 id="findfile"><a name="FindFile"></a>FindFile</h1>
<p>Call this function to open a file search.</p>
<pre><code>UNCTION FindFile (BYREF wszFileSpec AS WSTRING) AS LONG_PTR
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>wszFileSpec</em></td>
<td>A string containing the name of the file to find (must not end in a trailing backslash). If you pass an empty string, FindFile does a wildcard (<em>.</em>) search.<br>If the string ends with a wildcard, period (.), or directory name, the user must have access permissions to the root and all subdirectories on the path.<br>To extend the MAX_PATH limit to 32,767 wide characters, prepend &quot;\?&quot; to the path.</td>
</tr>
</tbody>
</table>
<h4 id="return-value">Return value</h4>
<p>S_OK on success or an error code on failure. To get extended error information, call <strong>GetLastError</strong>. If the function fails because no matching files can be found, the GetLastError function returns ERROR_FILE_NOT_FOUND.</p>
<h1 id="findnext"><a name="FindNext"></a>FindNext</h1>
<p>Call this method to continue a file search from a previous call to FindFile.</p>
<pre><code>FUNCTION FindNext () AS LONG
</code></pre>
<h4 id="return-value-1">Return value</h4>
<p>Nonzero if there are more files; zero if the file found is the last one in the directory or if an error occurred. To get extended error information, call <strong>GetLastError</strong>. If the file found is the last file in the directory, or if no matching files can be found, the <strong>GetLastError</strong> function returns ERROR_NO_MORE_FILES.</p>
<h1 id="iscompressedfile"><a name="IsCompressedFile"></a>IsCompressedFile</h1>
<p>Retuns TRUE if the found file is a compressed file. Otherwise FALSE.</p>
<pre><code>FUNCTION IsCompressedFile () AS BOOLEAN
</code></pre>
<h1 id="isdots"><a name="IsDots"></a>IsDots</h1>
<p>Returns TRUE if the found file has the name &quot;.&quot; or &quot;..&quot;, which indicates that the found file is actually a directory. Otherwise FALSE.</p>
<pre><code>FUNCTION IsDots () AS BOOLEAN
</code></pre>
<h1 id="isencryptedfile"><a name="IsEncryptedFile"></a>IsEncryptedFile</h1>
<p>Retuns TRUE if the found file is an encrypted file. Otherwise FALSE.</p>
<pre><code>FUNCTION IsEncryptedFile () AS BOOLEAN
</code></pre>
<h1 id="isfile"><a name="IsFile"></a>IsFile</h1>
<p>Retuns TRUE if the found file is a file and not a folder. Otherwise FALSE.</p>
<pre><code>FUNCTION IsFile () AS BOOLEAN
</code></pre>
<h1 id="isfolder"><a name="IsFolder"></a>IsFolder</h1>
<p>Retuns TRUE if the found file is a folder. Otherwise FALSE.</p>
<pre><code>FUNCTION IsFolder () AS BOOLEAN
</code></pre>
<h1 id="ishiddenfile"><a name="IsHiddenFile"></a>IsHiddenFile</h1>
<p>Retuns TRUE if the found file is a hidden file. Otherwise FALSE.</p>
<pre><code>FUNCTION IsHiddenFile  () AS BOOLEAN
</code></pre>
<h1 id="isnormalfile"><a name="IsNormalFile"></a>IsNormalFile</h1>
<p>Retuns TRUE if the found file is a normal file. Otherwise FALSE.</p>
<pre><code>FUNCTION IsNormalFile () AS BOOLEAN
</code></pre>
<h1 id="isnotcontentindexedfile"><a name="IsNotContentIndexedFile"></a>IsNotContentIndexedFile</h1>
<p>Retuns TRUE if the found file is not to be indexed by the content indexing service.. Otherwise FALSE.</p>
<pre><code>FUNCTION IsNotContentIndexedFile () AS BOOLEAN
</code></pre>
<h1 id="isofflinefile"><a name="IsOffLineFile"></a>IsOffLineFile</h1>
<p>Retuns TRUE if the found file is not available immediately. Otherwise FALSE.</p>
<pre><code>FUNCTION IsOffLineFile () AS BOOLEAN
</code></pre>
<h1 id="isreadonlyfile"><a name="IsReadOnlyFile"></a>IsReadOnlyFile</h1>
<p>Retuns TRUE if the found file is a read only file. Otherwise FALSE.</p>
<pre><code>FUNCTION IsReadOnlyFile () AS BOOLEAN
</code></pre>
<h1 id="isreparsepointfile"><a name="IsReparsePointFile"></a>IsReparsePointFile</h1>
<p>Retuns TRUE if the found file is a file or directory that has an associated reparse point, or a file that is a symbolic link. Otherwise FALSE.</p>
<pre><code>FUNCTION IsReparsePointFile () AS BOOLEAN
</code></pre>
<h1 id="issparsefile"><a name="IsSparseFile"></a>IsSparseFile</h1>
<p>Retuns TRUE if the found file is a sparse file. Otherwise FALSE.</p>
<pre><code>FUNCTION IsSparseFile () AS BOOLEAN
</code></pre>
<h1 id="issystemfile"><a name="IsSystemFile"></a>IsSystemFile</h1>
<p>Retuns TRUE if the found file is a system file. Otherwise FALSE.</p>
<pre><code>FUNCTION IsSystemFile () AS BOOLEAN
</code></pre>
<h1 id="istemporaryfile"><a name="IsTemporaryFile"></a>IsTemporaryFile</h1>
<p>Retuns TRUE if the found file is a temporary file. Otherwise FALSE.</p>
<pre><code>FUNCTION IsTemporaryFile () AS BOOLEAN
</code></pre>
<h1 id="lastaccesstime"><a name="LastAccessTime"></a>LastAccessTime</h1>
<p>Returns the time the file was last accessed, in local time format.</p>
<pre><code>FUNCTION LastAccessTime () AS FILETIME
</code></pre>
<h1 id="lastwritetime"><a name="LastWriteTime"></a>LastWriteTime</h1>
<p>Returns the time the file was written to, truncated, or overwritten, in local time format.</p>
<pre><code>FUNCTION LastWriteTime () AS FILETIME
</code></pre>
<h1 id="matchesmask"><a name="MatchesMask"></a>MatchesMask</h1>
<p>Call this method to test the file attributes on the found file.</p>
<pre><code>FUNCTION MatchesMask (BYVAL dwMask AS DWORD) AS BOOLEAN
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>dwMask</em></td>
<td>Specifies one or more file attributes, identified in the WIN32_FIND_DATAW structure, for the found file. To search for multiple attributes, use the bitwise OR operator.</td>
</tr>
</tbody>
</table>
<p>Any combination of the following attributes is acceptable:</p>
<table>
<thead>
<tr class="header">
<th>Attribute</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FILE_ATTRIBUTE_ARCHIVE</td>
<td>The file is an archive file. Applications use this attribute to mark files for backup or removal.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_COMPRESSED</td>
<td>The file or directory is compressed. For a file, this means that all of the data in the file is compressed. For a directory, this means that compression is the default for newly created files and subdirectories.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_DIRECTORY</td>
<td>The file is a directory.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_NORMAL</td>
<td>The file has no other attributes set. This attribute is valid only if used alone. All other file attributes override this attribute.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_HIDDEN</td>
<td>The file is hidden. It is not to be included in an ordinary directory listing.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_READONLY</td>
<td>The file is read only. Applications can read the file but cannot write to it or delete it.</td>
</tr>
<tr class="odd">
<td>FILE_ATTRIBUTE_SYSTEM</td>
<td>The file is part of or is used exclusively by the operating system.</td>
</tr>
<tr class="even">
<td>FILE_ATTRIBUTE_TEMPORARY</td>
<td>The file is being used for temporary storage. Applications should write to the file only if absolutely necessary. Most of the file's data remains in memory without being flushed to the media because the file will soon be deleted.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-2">Return value</h4>
<p>TRUE if successful; otherwise FALSE.</p>
<h1 id="root"><a name="Root"></a>Root</h1>
<p>Call this method to get the root of the found file.</p>
<pre><code>FUNCTION Root () AS CWSTR
</code></pre>
<h4 id="return-value-3">Return value</h4>
<p>This method returns the drive specifier and path name used to start a search. For example, calling <strong>FindFile</strong> with *.dat results in <strong>Root</strong> returning an empty string. Passing a path, such as c:\windows\system*.dll, to FindFile results <strong>Root</strong> returning c:\windows\system.</p>
<h1 id="shortfilename"><a name="ShortFileName"></a>ShortFileName</h1>
<p>Call this method to get an alternative name for the file. This name is in the classic 8.3 file name format.</p>
<pre><code>FUNCTION ShortFileName () AS CWSTR
</code></pre>
<h4 id="return-value-4">Return value</h4>
<p>The alternate name of the most-recently-found file, including the extension.</p>
</body>
</html>

