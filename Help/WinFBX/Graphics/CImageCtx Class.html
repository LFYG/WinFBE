<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta http-equiv='X-UA-Compatible' content='IE=edge' />
  <meta http-equiv='MSThemeCompatible' content='Yes'>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CImageCtx Class</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">@font-face {font-family: octicons-link;src: url(data:font/woff;charset=utf-8;base64,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) format('woff');}body {-webkit-text-size-adjust: 100%;text-size-adjust: 100%;color: #333;font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size: 16px;line-height: 1.6;word-wrap: break-word;max-width: 99%;box-sizing: border-box;padding: 20px 5px 8rem 5px; margin-left: auto;margin-right: auto;}body a {background-color: transparent;}body a:active,body a:hover {outline: 0;}body strong {font-weight: bold;}body h1 {font-size: 2em;margin: 0.67em 0;}body img {border: 0;}body hr {box-sizing: content-box;height: 0;}body pre {overflow: auto;}body code,body kbd,body pre {font-family: monospace, monospace;font-size: 1em;}body input {color: inherit;font: inherit;margin: 0;}body html input[disabled] {cursor: default;}body input {line-height: normal;}body input[type="checkbox"] {box-sizing: border-box;padding: 0;}body table {border-collapse: collapse;border-spacing: 0;}body td,body th {padding: 0;}body * {box-sizing: border-box;}body input {font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";}body a {color: #4078c0;text-decoration: none;}body a:hover,body a:active {text-decoration: underline;}body hr {height: 0;margin: 15px 0;overflow: hidden;background: transparent;border: 0;border-bottom: 1px solid #ddd;}body hr:before {display: table;content: "";}body hr:after {display: table;clear: both;content: "";}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 15px;margin-bottom: 15px;line-height: 1.1;}body h1 {font-size: 30px;}body h2 {font-size: 21px;}body h3 {font-size: 16px;}body h4 {font-size: 14px;}body h5 {font-size: 12px;}body h6 {font-size: 11px;}body blockquote {margin: 0;}body ul,body ol {padding: 0;margin-top: 0;margin-bottom: 0;}body ol ol,body ul ol {list-style-type: lower-roman;}body ul ul ol,body ul ol ol,body ol ul ol,body ol ol ol {list-style-type: lower-alpha;}body dd {margin-left: 0;}body code {font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;font-size: 12px;}body pre {margin-top: 0;margin-bottom: 0;font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;}body .select::-ms-expand {opacity: 0;}body .octicon {font: normal normal normal 16px/1 octicons-link;display: inline-block;text-decoration: none;text-rendering: auto;-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}body .octicon-link:before {content: '\f05c';}body:before {display: table;content: "";}body:after {display: table;clear: both;content: "";}body>*:first-child {margin-top: 0 !important;}body>*:last-child {margin-bottom: 0 !important;}body a:not([href]) {color: inherit;text-decoration: none;}body .anchor {display: inline-block;padding-right: 2px;margin-left: -18px;}body .anchor:focus {outline: none;}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 1em;margin-bottom: 16px;font-weight: bold;line-height: 1.4;}body h1 .octicon-link,body h2 .octicon-link,body h3 .octicon-link,body h4 .octicon-link,body h5 .octicon-link,body h6 .octicon-link {color: #000;vertical-align: middle;visibility: hidden;}body h1:hover .anchor,body h2:hover .anchor,body h3:hover .anchor,body h4:hover .anchor,body h5:hover .anchor,body h6:hover .anchor {text-decoration: none;}body h1:hover .anchor .octicon-link,body h2:hover .anchor .octicon-link,body h3:hover .anchor .octicon-link,body h4:hover .anchor .octicon-link,body h5:hover .anchor .octicon-link,body h6:hover .anchor .octicon-link {visibility: visible;}body h1 {padding-bottom: 0.3em;font-size: 1.75em;line-height: 1.2;}body h1 .anchor {line-height: 1;}body h2 {padding-bottom: 0.3em;font-size: 1.5em;line-height: 1.225;}body h2 .anchor {line-height: 1;}body h3 {font-size: 1.25em;line-height: 1.43;}body h3 .anchor {line-height: 1.2;}body h4 {font-size: 1em;}body h4 .anchor {line-height: 1.2;}body h5 {font-size: 1em;}body h5 .anchor {line-height: 1.1;}body h6 {font-size: 1em;color: #777;}body h6 .anchor {line-height: 1.1;}body p,body blockquote,body ul,body ol,body dl,body table,body pre {margin-top: 0;margin-bottom: 16px;}body hr {height: 4px;padding: 0;margin: 16px 0;background-color: #e7e7e7;border: 0 none;}body ul,body ol {padding-left: 2em;}body ul ul,body ul ol,body ol ol,body ol ul {margin-top: 0;margin-bottom: 0;}body li>p {margin-top: 16px;}body dl {padding: 0;}body dl dt {padding: 0;margin-top: 16px;font-size: 1em;font-style: italic;font-weight: bold;}body dl dd {padding: 0 16px;margin-bottom: 16px;}body blockquote {padding: 0 15px;color: #777;border-left: 4px solid #ddd;}body blockquote>:first-child {margin-top: 0;}body blockquote>:last-child {margin-bottom: 0;}body table {display: block;width: 100%;overflow: auto;word-break: normal;word-break: keep-all;}body table th {font-weight: bold;}body table th,body table td {padding: 6px 13px;border: 1px solid #ddd;}body table tr {background-color: #fff;border-top: 1px solid #ccc;}body table tr:nth-child(2n) {background-color: #f8f8f8;}body img {max-width: 100%;box-sizing: content-box;background-color: #fff;}body code {padding: 0;padding-top: 0;padding-bottom: 0;margin: 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}body code:before,body code:after {letter-spacing: -0.2em;content: "\00a0";}body pre>code {padding: 0;margin: 0;font-size: 100%;word-break: normal;white-space: pre;background: transparent;border: 0;}body .highlight {margin-bottom: 16px;}body .highlight pre,body pre {padding: 16px;overflow: auto;font-size: 85%;line-height: 1.45;background-color: #f7f7f7;border-radius: 3px;}body .highlight pre {margin-bottom: 0;word-break: normal;}body pre {word-wrap: normal;}body pre code {display: inline;max-width: initial;padding: 0;margin: 0;overflow: initial;line-height: inherit;word-wrap: normal;background-color: transparent;border: 0;}body pre code:before,body pre code:after {content: normal;}body kbd {display: inline-block;padding: 3px 5px;font-size: 11px;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .pl-c {color: #969896;}body .pl-c1,body .pl-s .pl-v {color: #0086b3;}body .pl-e,body .pl-en {color: #795da3;}body .pl-s .pl-s1,body .pl-smi {color: #333;}body .pl-ent {color: #63a35c;}body .pl-k {color: #a71d5d;}body .pl-pds,body .pl-s,body .pl-s .pl-pse .pl-s1,body .pl-sr,body .pl-sr .pl-cce,body .pl-sr .pl-sra,body .pl-sr .pl-sre {color: #183691;}body .pl-v {color: #ed6a43;}body .pl-id {color: #b52a1d;}body .pl-ii {background-color: #b52a1d;color: #f8f8f8;}body .pl-sr .pl-cce {color: #63a35c;font-weight: bold;}body .pl-ml {color: #693a17;}body .pl-mh,body .pl-mh .pl-en,body .pl-ms {color: #1d3e81;font-weight: bold;}body .pl-mq {color: #008080;}body .pl-mi {color: #333;font-style: italic;}body .pl-mb {color: #333;font-weight: bold;}body .pl-md {background-color: #ffecec;color: #bd2c00;}body .pl-mi1 {background-color: #eaffea;color: #55a532;}body .pl-mdr {color: #795da3;font-weight: bold;}body .pl-mo {color: #1d3e81;}body kbd {display: inline-block;padding: 3px 5px;font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .task-list-item {list-style-type: none;}body .task-list-item+.task-list-item {margin-top: 3px;}body .task-list-item input {margin: 0 0.35em 0.25em -1.6em;vertical-align: middle;}body :checked+.radio-label {z-index: 1;position: relative;border-color: #4078c0;}</style>
  
    
  
</head>
<body>
<h1 id="cimagectx-class">CImageCtx Class</h1>
<p><strong>CImageCtx</strong> is an image control based on GDI+. The images can be rendered using its actual size or can be resized to fit the width or the height of the window. Resizing is done automatically by the control.</p>
<p>To use the control, include the <strong>CImageCtx.inc</strong> file in your program and use the namespace <strong>Afx</strong>.</p>
<p>Include file: CImageCtx.inc</p>
<h3 id="constructor">Constructor</h3>
<p>Registers the class name and creates an instance of the control.</p>
<pre><code>CONSTRUCTOR CImageCtx (BYVAL pWindow AS CWindow PTR, BYVAL cID AS INTEGER, _
   BYREF wszTitle AS CONST WSTRING = &quot;&quot;, BYVAL x AS LONG = 0, BYVAL y AS LONG = 0, _
   BYVAL nWidth AS LONG = 0, BYVAL nHeight AS LONG = 0, BYVAL dwStyle AS DWORD = 0, _
   BYVAL dwExStyle AS DWORD = 0, BYVAL lpParam AS LONG_PTR = 0)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>pWindow</em></td>
<td>Pointer to the <strong>CWindow</strong> class of the parent window.</td>
</tr>
<tr class="even">
<td><em>cID</em></td>
<td>Control identifier.</td>
</tr>
<tr class="odd">
<td><em>wszTitle</em></td>
<td>The window caption. If &quot;OPENGL&quot; is used as the caption, support for OpenGL is added to the control.</td>
</tr>
<tr class="even">
<td><em>x</em></td>
<td>The x-coordinate of the upper-left corner of the window relative to the upper-left corner of the parent window's client area.</td>
</tr>
<tr class="odd">
<td><em>y</em></td>
<td>The initial y-coordinate of the upper-left corner of the window relative to the upper-left corner of the parent window's client area.</td>
</tr>
<tr class="even">
<td><em>nWidth</em></td>
<td>The width of the control.</td>
</tr>
<tr class="odd">
<td><em>nHeight</em></td>
<td>The height of the control.</td>
</tr>
<tr class="even">
<td><em>dwStyle</em></td>
<td>The style of the window being created. Pass -1 to use the default styles.<br>Default styles: WS_VISIBLE OR WS_CHILD OR WS_TABSTOP.</td>
</tr>
<tr class="odd">
<td><em>dwExStyle</em></td>
<td>The extended window style of the control being created. Pass -1 to use the default styles.</td>
</tr>
<tr class="even">
<td><em>lpParam</em></td>
<td>Pointer to custom data.</td>
</tr>
</tbody>
</table>
<h4 id="return-value">Return value</h4>
<p>A pointer to the new instance of the class.</p>
<h4 id="usage-example:">Usage example:</h4>
<pre><code>' // Create the main window
DIM pWindow AS CWindow
pWindow.Create(NULL, &quot;CWindow with an image control&quot;, @WndProc)
pWindow.SetClientSize(600, 350)
pWindow.Center

' // Add an image control
DIM pImageCtx AS CImageCtx = CImageCtx(@pWindow, IDC_IMAGECTX, &quot;&quot;, 0, 0, pWindow.ClientWidth, pWindow.ClientHeight)
' // Load an image from disk
pImageCtx.LoadImageFromFile ExePath &amp; &quot;\image.jpg&quot;
</code></pre>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#Demo">Demo</a></td>
<td>CWindow CImage Control demo.</td>
</tr>
</tbody>
</table>
<h3 id="helper-procedure:-afxcimagectxptr">Helper Procedure: AfxCImageCtxPtr</h3>
<p>Returns a pointer to the CIMageCtx class given the handle of its associated window.</p>
<pre><code>FUNCTION AfxCImageCtxPtr (BYVAL hwnd AS HWND) AS CImageCtx PTR
FUNCTION AfxCImageCtxPtr (BYVAL hParent AS HWND, BYVAL cID AS LONG) AS CImageCtx PTR
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hwnd</em></td>
<td>Handle of the window associated with the graphic control. Call the <strong>hWindow</strong> method of the <strong>CImageCtx</strong> class to retrieve it.</td>
</tr>
<tr class="even">
<td><em>hParent</em></td>
<td>The handle of the parent window of the control.</td>
</tr>
<tr class="odd">
<td><em>cID</em></td>
<td>The identifier of the control.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-1">Return value</h4>
<p>A pointer to the CImageCtx class.</p>
<h3 id="methods-and-properties">Methods and Properties</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#Clear">Clear</a></td>
<td>Clears the contents of the controlr.</td>
</tr>
<tr class="even">
<td><a href="#GetBkColor">GetBkColor</a></td>
<td>Gets the background RGB color used by the <strong>CImageCtx</strong> control.</td>
</tr>
<tr class="odd">
<td><a href="#GetBkColorHot">GetBkColorHot</a></td>
<td>Gets the background hot RGB color used by the <strong>CImageCtx</strong> control.</td>
</tr>
<tr class="even">
<td><a href="#GetImageAdjustment">GetImageAdjustment</a></td>
<td>Gets the image adjustment setting used by the control.</td>
</tr>
<tr class="odd">
<td><a href="#GetImageHeight">GetImageHeight</a></td>
<td>Gets the height of the image, in pixels, currently loaded in the <strong>CImageCtx</strong> control.</td>
</tr>
<tr class="even">
<td><a href="#GetImagePtr">GetImagePtr</a></td>
<td>Gets a pointer to the GDI+ GpImage object used by the control to render the loaded image.</td>
</tr>
<tr class="odd">
<td><a href="#GetImageWidth">GetImageWidth</a></td>
<td>Gets the width of the image, in pixels, currently loaded in the control.</td>
</tr>
<tr class="even">
<td><a href="#GetInterpolationMode">GetInterpolationMode</a></td>
<td>Gets the interpolation mode used by GDI+.</td>
</tr>
<tr class="odd">
<td><a href="#hWindow">hWindow</a></td>
<td>Returns the handle of the control.</td>
</tr>
<tr class="even">
<td><a href="#LoadBitmapFromResource">LoadBitmapFromResource</a></td>
<td>Loads a bitmap from a resource file into the control.</td>
</tr>
<tr class="odd">
<td><a href="#LoadImageFromFile">LoadImageFromFile</a></td>
<td>Loads an image from disk into the control.</td>
</tr>
<tr class="even">
<td><a href="#LoadImageFromResource">LoadImageFromResource</a></td>
<td>Loads an image from a resource file into the control.</td>
</tr>
<tr class="odd">
<td><a href="#Redraw">Redraw</a></td>
<td>Redraws the <strong>CImageCtx</strong> control.</td>
</tr>
<tr class="even">
<td><a href="#SetBkColor">SetBkColor</a></td>
<td>Sets the background RGB color used by the <strong>CImageCtx</strong> control.</td>
</tr>
<tr class="odd">
<td><a href="#SetBkColorHot">SetBkColorHot</a></td>
<td>Sets the background hot RGB color used by the <strong>CImageCtx</strong> control.</td>
</tr>
<tr class="even">
<td><a href="#SetImageAdjustment">SetImageAdjustment</a></td>
<td>Sets the image adjustment setting used by the control.</td>
</tr>
<tr class="odd">
<td><a href="#SetImageHeight">SetImageHeight</a></td>
<td>Sets the height of the image.</td>
</tr>
<tr class="even">
<td><a href="#SetImageSize">SetImageSize</a></td>
<td>Sets the size of the image.</td>
</tr>
<tr class="odd">
<td><a href="#SetImageWidth">SetImageWidth</a></td>
<td>Sets the width of the image.</td>
</tr>
<tr class="even">
<td><a href="#SetInterpolationMode">SetInterpolationMode</a></td>
<td>Sets the interpolation mode used by GDI+.</td>
</tr>
</tbody>
</table>
<h3 id="notification-messages">Notification Messages</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#NM_CLICK">NM_CLICK</a></td>
<td>Sent by the control when the user clicks it with the left mouse button.</td>
</tr>
<tr class="even">
<td><a href="#NM_DBLCLK">NM_DBLCLK</a></td>
<td>Sent by the control when the user double clicks it with the left mouse button.</td>
</tr>
<tr class="odd">
<td><a href="#NM_KILLFOCUS">NM_KILLFOCUS</a></td>
<td>Notifies a control's parent window that the control has lost the input focus.</td>
</tr>
<tr class="even">
<td><a href="#NM_RCLICK">NM_RCLICK</a></td>
<td>Sent by the control when the user clicks it with the right mouse button.</td>
</tr>
<tr class="odd">
<td><a href="#NM_RDBLCLK">NM_RDBLCLK</a></td>
<td>Sent by the control when the user double clicks it with the right mouse button.</td>
</tr>
<tr class="even">
<td><a href="#NM_SETFOCUS">NM_SETFOCUS</a></td>
<td>Notifies a control's parent window that the control has received the input focus.</td>
</tr>
</tbody>
</table>
<h1 id="nm_click-notification-message"><a name="NM_CLICK"></a>NM_CLICK Notification Message</h1>
<p>Sent by the control when the user clicks it with the left mouse button. This notification code is sent in the form of a WM_NOTIFY message.</p>
<pre><code>CASE WM_NOTIFY
   DIM phdr AS NMHDR PTR = CAST(NMHDR PTR, lParam)
   IF wParam = IDC_IMGCTX THEN
      SELECT CASE phdr-&gt;code
         CASE NM_CLICK
            ' Left button clicked
      END SELECT
   END IF
END IF
</code></pre>
<h4 id="remarks">Remarks</h4>
<p>IDC_IMGCTX is the constant value used as identifier of the control. Change it if needed.</p>
<h1 id="nm_dblclk-notification-message"><a name="NM_DBLCLK"></a>NM_DBLCLK Notification Message</h1>
<p>Sent by the control when the user double clicks it with the left mouse button. This notification code is sent in the form of a WM_NOTIFY message.</p>
<pre><code>CASE WM_NOTIFY
   DIM phdr AS NMHDR PTR = CAST(NMHDR PTR, lParam)
   IF wParam = IDC_IMGCTX THEN
      SELECT CASE phdr-&gt;code
         CASE NM_DBLCLK
            ' Left button double clicked
      END SELECT
   END IF
END IF
</code></pre>
<h4 id="remarks-1">Remarks</h4>
<p>IDC_IMGCTX is the constant value used as identifier of the control. Change it if needed.</p>
<h1 id="nm_killfocus-notification-message"><a name="NM_KILLFOCUS"></a>NM_KILLFOCUS Notification Message</h1>
<p>Notifies a control's parent window that the control has lost the input focus. This notification code is sent in the form of a WM_NOTIFY message.</p>
<pre><code>CASE WM_NOTIFY
   DIM phdr AS NMHDR PTR = CAST(NMHDR PTR, lParam)
   IF wParam = IDC_IMGCTX THEN
      SELECT CASE phdr-&gt;code
         CASE NM_KILLFOCUS
            ' The control has lost focus
      END SELECT
   END IF
END IF
</code></pre>
<h4 id="remarks-2">Remarks</h4>
<p>IDC_IMGCTX is the constant value used as identifier of the control. Change it if needed.</p>
<h1 id="nm_rclick-notification-message"><a name="NM_RCLICK"></a>NM_RCLICK Notification Message</h1>
<p>Notifies a control's parent window that the control has lost the input focus. This notification code is sent in the form of a WM_NOTIFY message.</p>
<pre><code>CASE WM_NOTIFY
   DIM phdr AS NMHDR PTR = CAST(NMHDR PTR, lParam)
   IF wParam = IDC_IMGCTX THEN
      SELECT CASE phdr-&gt;code
         CASE NM_RCLICK
            ' Right button clicked
      END SELECT
   END IF
END IF
</code></pre>
<h4 id="remarks-3">Remarks</h4>
<p>IDC_IMGCTX is the constant value used as identifier of the control. Change it if needed.</p>
<h1 id="nm_rdblclk-notification-message"><a name="NM_RDBLCLK"></a>NM_RDBLCLK Notification Message</h1>
<p>Sent by the control when the user double clicks it with the right mouse button. This notification code is sent in the form of a WM_NOTIFY message.</p>
<pre><code>CASE WM_NOTIFY
   DIM phdr AS NMHDR PTR = CAST(NMHDR PTR, lParam)
   IF wParam = IDC_IMGCTX THEN
      SELECT CASE phdr-&gt;code
         CASE NM_RDBLCLK
            ' Right button double clicked
      END SELECT
   END IF
END IF
</code></pre>
<h4 id="remarks-4">Remarks</h4>
<p>IDC_IMGCTX is the constant value used as identifier of the control. Change it if needed.</p>
<h1 id="nm_setfocus-notification-message"><a name="NM_SETFOCUS"></a>NM_SETFOCUS Notification Message</h1>
<p>Notifies a control's parent window that the control has received the input focus. This notification code is sent in the form of a WM_NOTIFY message.</p>
<pre><code>CASE WM_NOTIFY
   DIM phdr AS NMHDR PTR = CAST(NMHDR PTR, lParam)
   IF wParam = IDC_IMGCTX THEN
      SELECT CASE phdr-&gt;code
         CASE NM_SETFOCUS
            ' The control has gained focus
      END SELECT
   END IF
END IF
</code></pre>
<h4 id="remarks-5">Remarks</h4>
<p>IDC_IMGCTX is the constant value used as identifier of the control. Change it if needed.</p>
<h1 id="clear"><a name="Clear"></a>Clear</h1>
<p>Clears the contents of the control.</p>
<pre><code>SUB Clear
</code></pre>
<h1 id="getbkcolor"><a name="GetBkColor"></a>GetBkColor</h1>
<p>Gets the background RGB color used by the <strong>CImageCtx</strong> control.</p>
<pre><code>FUNCTION GetBkColor () AS LONG
</code></pre>
<h1 id="getbkcolorhot"><a name="GetBkColorHot"></a>GetBkColorHot</h1>
<p>Gets the background hot RGB color used by the <strong>CImageCtx</strong> control (when the mouse is over the control).</p>
<pre><code>FUNCTION GetBkColorHot () AS LONG
</code></pre>
<h1 id="getimageadjustment"><a name="GetImageAdjustment"></a>GetImageAdjustment</h1>
<p>Gets the image adjustment setting used by the control.</p>
<pre><code>FUNCTION GetImageAdjustment () AS LONG
</code></pre>
<h4 id="return-value-2">Return value</h4>
<p>The current adjustment setting, that can be one of the following values:</p>
<table>
<thead>
<tr class="header">
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>GDIP_IMAGECTX_AUTOSIZE</strong></td>
<td>Autoadjusts the image to the width or height of the control.</td>
</tr>
<tr class="even">
<td><strong>GDIP_IMAGECTX_ACTUALSIZE</strong></td>
<td>Shows the image with its actual size.</td>
</tr>
<tr class="odd">
<td><strong>GDIP_IMAGECTX_FITTOWIDTH</strong></td>
<td>Adjusts the image to the width of the control.</td>
</tr>
<tr class="even">
<td><strong>GDIP_IMAGECTX_FITTOHEIGHT</strong></td>
<td>Adjusts the image to the height of the control.</td>
</tr>
<tr class="odd">
<td><strong>GDIP_IMAGECTX_STRETCH</strong></td>
<td>Adjusts the image to the height and width of the control.</td>
</tr>
</tbody>
</table>
<h1 id="getimageheight"><a name="GetImageHeight"></a>GetImageHeight</h1>
<p>Gets the height of the image, in pixels, currently loaded in the <strong>CImageCtx</strong> control.</p>
<pre><code>FUNCTION GetImageHeight () AS LONG
</code></pre>
<h1 id="getimageptr"><a name="GetImagePtr"></a>GetImagePtr</h1>
<p>Gets a pointer to the GDI+ <strong>GpImage</strong> object used by the control to render the loaded image.</p>
<pre><code>FUNCTION GetImagePtr () AS GpImage PTR
</code></pre>
<h4 id="return-value-3">Return value</h4>
<p>A copy of the pointer to the <strong>GpImage</strong> object used by the control to render the loaded image.</p>
<h3 id="remarks-6">Remarks</h3>
<p>The returned pointer can be used to call GDI+ Image functions.</p>
<p>Don't dispose the returned pointer. The control keeps a copy of it and calls <strong>GdipDisposeImage</strong> when it is destroyed.</p>
<h1 id="getimagewidth"><a name="GetImageWidth"></a>GetImageWidth</h1>
<p>Gets the with of the image, in pixels, currently loaded in the <strong>CImageCtx</strong> control.</p>
<pre><code>FUNCTION GetImageWidth () AS LONG
</code></pre>
<h1 id="getinterpolationmode"><a name="GetInterpolationMode"></a>GetInterpolationMode</h1>
<p>Gets the interpolation mode used by GDI+.</p>
<pre><code>FUNCTION GetInterpolationMode () AS LONG
</code></pre>
<h4 id="return-value-4">Return value</h4>
<p>The current interpolation mode value.</p>
<pre><code>InterpolationModeInvalid = -1
InterpolationModeDefault = 0
InterpolationModeLowQuality = 1
InterpolationModeHighQuality = 2
InterpolationModeBilinear = 3
InterpolationModeBicubic = 4
InterpolationModeNearestNeighbor = 5
InterpolationModeHighQualityBilinear = 6
InterpolationModeHighQualityBicubic = 7
</code></pre>
<h1 id="hwindow"><a name="hWindow"></a>hWindow</h1>
<p>Returns the handle of the control.</p>
<pre><code>FUNCTION hWindow () AS HWND
</code></pre>
<h1 id="loadbitmapfromresource"><a name="LoadBitmapFromResource"></a>LoadBitmapFromResource</h1>
<p>Loads a bitmap from a resource file into the control. <strong>Note</strong>: Works with .bmp and .png files, but not with .jpg and .tif files.</p>
<pre><code>FUNCTION LoadBitmapFromResource (BYVAL hInstance AS HINSTANCE, BYREF wszResourceName AS WSTRING) AS LONG
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hInstance</em></td>
<td>Handle to the instance of the module whose executable file contains the resource. A value of NULL specifies the module handle associated with the image file that the operating system used to create the current process.</td>
</tr>
<tr class="even">
<td><em>wszResourceName</em></td>
<td>The name of the resource.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-5">Return value</h4>
<p>Ok (0) or an error code.</p>
<h1 id="loadimagefromfile"><a name="LoadImageFromFile"></a>LoadImageFromFile</h1>
<p>Loads an image from disk into the control.</p>
<pre><code>FUNCTION LoadImageFromFile (BYREF wszFileName AS WSTRING) AS LONG
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>wszFileName</em></td>
<td>Fully qualified path and filename of the image file to load.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-6">Return value</h4>
<p>Ok (0) or an error code.</p>
<h1 id="loadimagefromresource"><a name="LoadImageFromResource"></a>LoadImageFromResource</h1>
<p>Loads an image from a resource file into the control. <strong>Note</strong>: Works with .bmp and .png files, but not with .jpg and .tif files.</p>
<pre><code>FUNCTION LoadImageFromResource (BYVAL hInstance AS HINSTANCE, BYREF wszResourceName AS WSTRING) AS LONG
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hInstance</em></td>
<td>Handle to the instance of the module whose executable file contains the resource. A value of NULL specifies the module handle associated with the image file that the operating system used to create the current process.</td>
</tr>
<tr class="even">
<td><em>wszResourceName</em></td>
<td>The name of the resource.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-7">Return value</h4>
<p>Ok (0) or an error code.</p>
<h1 id="redraw"><a name="Redraw"></a>Redraw</h1>
<p>Redraws the <strong>CImageCtx</strong> control.</p>
<pre><code>SUB Redraw
</code></pre>
<h1 id="setbkcolor"><a name="SetBkColor"></a>SetBkColor</h1>
<p>Sets the background RGB color used by the <strong>CImageCtx</strong> control.</p>
<pre><code>FUNCTION SetBkColor (BYVAL clr AS LONG, BYVAL fRedraw AS BOOLEAN = FALSE) AS LONG
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>clr</em></td>
<td>The new RGB background color.</td>
</tr>
<tr class="even">
<td><em>fRedraw</em></td>
<td>Optional. TRUE to redraw the control to reflect the changes.</td>
</tr>
</tbody>
</table>
<h1 id="setbkcolorhot"><a name="SetBkColorHot"></a>SetBkColorHot</h1>
<p>Sets the background hot RGB color used by the <strong>CImageCtx</strong> control (when the mouse i over the control).</p>
<pre><code>FUNCTION SetBkColorHot (BYVAL clr AS LONG, BYVAL fRedraw AS BOOLEAN = FALSE) AS LONG
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>clr</em></td>
<td>The new RGB background color.</td>
</tr>
<tr class="even">
<td><em>fRedraw</em></td>
<td>Optional. TRUE to redraw the control to reflect the changes.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-8">Return value</h4>
<p>The previous background color.</p>
<h1 id="setimageadjustment"><a name="SetImageAdjustment"></a>SetImageAdjustment</h1>
<p>Sets the image adjustment setting used by the control.</p>
<pre><code>FUNCTION SetImageAdjustment (BYVAL ImageAdjustment AS LONG, BYVAL fRedraw AS BOOLEAN = FALSE) AS LONG
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>ImageAdjustment</em></td>
<td>The setting to set. Can be one of the values listed below.</td>
</tr>
<tr class="even">
<td><em>fRedraw</em></td>
<td>Optional. TRUE to redraw the control to reflect the changes.</td>
</tr>
</tbody>
</table>
<h3 id="image-adjustment-constants">Image adjustment constants</h3>
<table>
<thead>
<tr class="header">
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>GDIP_IMAGECTX_AUTOSIZE</strong></td>
<td>Autoadjusts the image to the width or height of the control.</td>
</tr>
<tr class="even">
<td><strong>GDIP_IMAGECTX_ACTUALSIZE</strong></td>
<td>Shows the image with its actual size.</td>
</tr>
<tr class="odd">
<td><strong>GDIP_IMAGECTX_FITTOWIDTH</strong></td>
<td>Adjusts the image to the width of the control.</td>
</tr>
<tr class="even">
<td><strong>GDIP_IMAGECTX_FITTOHEIGHT</strong></td>
<td>Adjusts the image to the height of the control.</td>
</tr>
<tr class="odd">
<td><strong>GDIP_IMAGECTX_STRETCH</strong>*</td>
<td>Adjusts the image to the height and width of the control.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-9">Return value</h4>
<p>The previous setting value.</p>
<h1 id="setimageheight"><a name="SetImageHeight"></a>SetImageHeight</h1>
<p>Sets the height of the image.</p>
<pre><code>SUB SetImageHeight (BYVAL nHeight AS LONG, BYVAL fRedraw AS BOOLEAN = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nHeight</em></td>
<td>Height of the image, in pixels.</td>
</tr>
<tr class="even">
<td><em>fRedraw</em></td>
<td>Optional. TRUE to redraw the control to reflect the changes.</td>
</tr>
</tbody>
</table>
<h1 id="setimagesize"><a name="SetImageSize"></a>SetImageSize</h1>
<p>Sets the size of the image.</p>
<pre><code>SUB SetImageSize (BYVAL nWidth AS LONG, BYVAL nHeight AS LONG, BYVAL fRedraw AS BOOLEAN = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nWidth</em></td>
<td>Width of the image, in pixels.</td>
</tr>
<tr class="even">
<td><em>nHeight</em></td>
<td>Height of the image, in pixels.</td>
</tr>
<tr class="odd">
<td><em>fRedraw</em></td>
<td>Optional. TRUE to redraw the control to reflect the changes.</td>
</tr>
</tbody>
</table>
<h1 id="setimagewidth"><a name="SetImageWidth"></a>SetImageWidth</h1>
<p>Sets the width of the image.</p>
<pre><code>SUB SetImageWidth (BYVAL nWidth AS LONG, BYVAL fRedraw AS BOOLEAN = FALSE)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nWidth</em></td>
<td>Height of the image, in pixels.</td>
</tr>
<tr class="even">
<td><em>fRedraw</em></td>
<td>Optional. TRUE to redraw the control to reflect the changes.</td>
</tr>
</tbody>
</table>
<h1 id="setinterpolationmode"><a name="SetInterpolationMode"></a>SetInterpolationMode</h1>
<p>Sets the interpolation mode used by GDI+. The interpolation mode determines the algorithm that is used when images are scaled or rotated.</p>
<pre><code>SUB SetInterpolationMode (BYVAL InterpolationMode AS LONG)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>InterpolationMode</em></td>
<td>The interpolation mode. Should be one of the following values:</td>
</tr>
</tbody>
</table>
<h3 id="interpolation-modes">Interpolation modes</h3>
<pre><code>InterpolationModeInvalid = -1
InterpolationModeDefault = 0
InterpolationModeLowQuality = 1
InterpolationModeHighQuality = 2
InterpolationModeBilinear = 3
InterpolationModeBicubic = 4
InterpolationModeNearestNeighbor = 5
InterpolationModeHighQualityBilinear = 6
InterpolationModeHighQualityBicubic = 7
</code></pre>
<h4 id="return-value-10">Return value</h4>
<p>The previous setting value.</p>
<h1 id="demo"><a name="Demo"></a>Demo</h1>
<pre><code>' ########################################################################################
' Microsoft Windows
' File: ImageCtx_Demo
' Contents: Image control demo
' Compiler: FreeBasic 32 &amp; 64 bit
' Copyright (c) 2016 José Roca. Freeware. Use at your own risk.
' THIS CODE AND INFORMATION IS PROVIDED &quot;AS IS&quot; WITHOUT WARRANTY OF ANY KIND, EITHER
' EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED WARRANTIES OF
' MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.
' ########################################################################################

#define _WIN32_WINNT &amp;h0602
#INCLUDE ONCE &quot;Afx/CWindow.inc&quot;
#INCLUDE ONCE &quot;Afx/CImageCtx.inc&quot;

USING Afx

CONST IDC_LOAD              = 100
CONST IDC_IMAGECTX          = 101
CONST IDC_RADIO_AUTOSIZE    = 102
CONST IDC_RADIO_ACTUALSIZE  = 103
CONST IDC_RADIO_FITTOHEIGHT = 104
CONST IDC_RADIO_FITTOWIDTH  = 105
CONST IDC_RADIO_STRETCH     = 106

DECLARE FUNCTION WinMain (BYVAL hInstance AS HINSTANCE, _
                          BYVAL hPrevInstance AS HINSTANCE, _
                          BYVAL szCmdLine AS ZSTRING PTR, _
                          BYVAL nCmdShow AS LONG) AS LONG

   END WinMain(GetModuleHandleW(NULL), NULL, COMMAND(), SW_NORMAL)

' // Forward declaration
DECLARE FUNCTION WndProc (BYVAL hwnd AS HWND, BYVAL uMsg AS UINT, BYVAL wParam AS WPARAM, BYVAL lParam AS LPARAM) AS LRESULT

' ========================================================================================
' Displays the File Open Dialog and loads the selected file in the image control.
' ========================================================================================
SUB AfxLoadFileDialog (BYVAL hwndOwner AS HWND, BYVAL pImageCtx AS CImageCtx PTR, BYVAL sigdnName AS SIGDN = SIGDN_FILESYSPATH)

   ' // Create an instance of the FileOpenDialog interface
   DIM hr AS LONG
   DIM pofd AS IFileOpenDialog PTR
   hr = CoCreateInstance(@CLSID_FileOpenDialog, NULL, CLSCTX_INPROC_SERVER, @IID_IFileOpenDialog, @pofd)
   IF pofd = NULL THEN EXIT SUB

   ' // Set the file types
   DIM rgFileTypes(1 TO 5) AS COMDLG_FILTERSPEC
   rgFileTypes(1).pszName = @WSTR(&quot;JPG Files (*.jpg)&quot;)
   rgFileTypes(2).pszName = @WSTR(&quot;BMP Files (*.bmp)&quot;)
   rgFileTypes(3).pszName = @WSTR(&quot;PNG Files (*.png)&quot;)
   rgFileTypes(4).pszName = @WSTR(&quot;TIF Files (*.tif)&quot;)
   rgFileTypes(5).pszName = @WSTR(&quot;All files&quot;)
   rgFileTypes(1).pszSpec = @WSTR(&quot;*.jpg&quot;)
   rgFileTypes(2).pszSpec = @WSTR(&quot;*.bmp&quot;)
   rgFileTypes(3).pszSpec = @WSTR(&quot;*.png&quot;)
   rgFileTypes(4).pszSpec = @WSTR(&quot;*.tif&quot;)
   rgFileTypes(5).pszSpec = @WSTR(&quot;*.*&quot;)
   pofd-&gt;lpVtbl-&gt;SetFileTypes(pofd, 5, @rgFileTypes(1))

   ' // Set the title of the dialog
   hr = pofd-&gt;lpVtbl-&gt;SetTitle(pofd, &quot;A Single-Selection Dialog&quot;)
   ' // Display the dialog
   hr = pofd-&gt;lpVtbl-&gt;Show(pofd, hwndOwner)

   ' // Set the default folder
   DIM pFolder AS IShellItem PTR
   SHCreateItemFromParsingName (CURDIR, NULL, @IID_IShellItem, @pFolder)
   IF pFolder THEN
      pofd-&gt;lpVtbl-&gt;SetDefaultFolder(pofd, pFolder)
      pFolder-&gt;lpVtbl-&gt;Release(pFolder)
   END IF

   ' // Get the result
   DIM pItem AS IShellItem PTR
   DIM pwszName AS WSTRING PTR
   IF SUCCEEDED(hr) THEN
      hr = pofd-&gt;lpVtbl-&gt;GetResult(pofd, @pItem)
      IF SUCCEEDED(hr) THEN
         hr = pItem-&gt;lpVtbl-&gt;GetDisplayName(pItem, sigdnName, @pwszName)
         pImageCtx-&gt;LoadImageFromFile(*pwszName)
         CoTaskMemFree(pwszName)
      END IF
   END IF

   ' // Cleanup
   IF pItem THEN pItem-&gt;lpVtbl-&gt;Release(pItem)
   IF pofd THEN pofd-&gt;lpVtbl-&gt;Release(pofd)

END SUB
' ========================================================================================

' ========================================================================================
' Main
' ========================================================================================
FUNCTION WinMain (BYVAL hInstance AS HINSTANCE, _
                  BYVAL hPrevInstance AS HINSTANCE, _
                  BYVAL szCmdLine AS ZSTRING PTR, _
                  BYVAL nCmdShow AS LONG) AS LONG

   ' // Initialize the COM library
   CoInitialize(NULL)

   ' // Set process DPI aware
   ' // The recommended way is to use a manifest
'   AfxSetProcessDPIAware

   ' // Create the main window
   DIM pWindow AS CWindow
   pWindow.Create(NULL, &quot;CWindow with an image control&quot;, @WndProc)
   pWindow.SetClientSize(600, 350)
   pWindow.Center

   ' // Add a button without coordinates (it will be reiszed in WM_SIZE, below)
   DIM hCtl AS HWND = pWindow.AddControl(&quot;RadioButton&quot;, , IDC_RADIO_AUTOSIZE, &quot;Autosize&quot;)
   SendMessageW hCtl, BM_SETCHECK, BST_CHECKED, 0
   SetFocus hCtl
   pWindow.AddControl(&quot;RadioButton&quot;, , IDC_RADIO_ACTUALSIZE, &quot;Actual size&quot;)
   pWindow.AddControl(&quot;RadioButton&quot;, , IDC_RADIO_FITTOWIDTH, &quot;Fit to width&quot;)
   pWindow.AddControl(&quot;RadioButton&quot;, , IDC_RADIO_FITTOHEIGHT, &quot;Fit to height&quot;)
   pWindow.AddControl(&quot;RadioButton&quot;, , IDC_RADIO_STRETCH, &quot;Stretch&quot;)
   pWindow.AddControl(&quot;Button&quot;, , IDC_LOAD, &quot;Load&quot;)
   pWindow.AddControl(&quot;Button&quot;, , IDCANCEL, &quot;Close&quot;)

   ' // Add an image control
   DIM pImageCtx AS CImageCtx = CImageCtx(@pWindow, IDC_IMAGECTX, , 0, 0, pWindow.ClientWidth, pWindow.ClientHeight)
   ' // Load an image from disk
   pImageCtx.LoadImageFromFile &quot;.\Images\Ciutat_de_les_Arts_i_de_les_Ciencies_01.jpg&quot;


   ' // Process Windows messages
   FUNCTION = pWindow.DoEvents(nCmdShow)

   ' // Uninitialize the COM library
   CoUninitialize

END FUNCTION
' ========================================================================================

' ========================================================================================
' Window procedure
' ========================================================================================
FUNCTION WndProc (BYVAL hwnd AS HWND, BYVAL uMsg AS UINT, BYVAL wParam AS WPARAM, BYVAL lParam AS LPARAM) AS LRESULT

   DIM pWindow AS CWindow PTR, pImageCtx AS CImageCtx PTR

   SELECT CASE uMsg

      CASE WM_COMMAND
         SELECT CASE GET_WM_COMMAND_ID(wParam, lParam)
            CASE IDCANCEL
               ' // If ESC key pressed, close the application sending an WM_CLOSE message
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  SendMessageW hwnd, WM_CLOSE, 0, 0
                  EXIT FUNCTION
               END IF
            CASE IDC_LOAD
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  ' // Load the picture
                  AfxLoadFileDialog hwnd, AfxCImageCtxPtr(hwnd, IDC_IMAGECTX)
               END IF
            CASE IDC_RADIO_AUTOSIZE
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  AfxCImageCtxPtr(hwnd, IDC_IMAGECTX)-&gt;SetImageAdjustment GDIP_IMAGECTX_AUTOSIZE, CTRUE
                  ' // Alternate way: Get a pointer to the CImageCtx class
'                  pImageCtx = CAST(CImageCtx PTR, GetWindowLongPtr(GetDlgItem(hwnd, IDC_IMAGECTX), 0))
'                  pImageCtx-&gt;SetImageAdjustment GDIP_IMAGECTX_AUTOSIZE, CTRUE
                  EXIT FUNCTION
               END IF
            CASE IDC_RADIO_ACTUALSIZE
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  AfxCImageCtxPtr(hwnd, IDC_IMAGECTX)-&gt;SetImageAdjustment GDIP_IMAGECTX_ACTUALSIZE, CTRUE
                  ' // Alternate way: Get a pointer to the CImageCtx class
'                  pImageCtx = CAST(CImageCtx PTR, GetWindowLongPtr(GetDlgItem(hwnd, IDC_IMAGECTX), 0))
'                  pImageCtx-&gt;SetImageAdjustment GDIP_IMAGECTX_ACTUALSIZE, CTRUE
                  EXIT FUNCTION
               END IF
            CASE IDC_RADIO_FITTOWIDTH
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  AfxCImageCtxPtr(hwnd, IDC_IMAGECTX)-&gt;SetImageAdjustment GDIP_IMAGECTX_FITTOWIDTH, CTRUE
                  ' // Alternate way: Get a pointer to the CImageCtx class
'                  pImageCtx = CAST(CImageCtx PTR, GetWindowLongPtr(GetDlgItem(hwnd, IDC_IMAGECTX), 0))
'                  pImageCtx-&gt;SetImageAdjustment GDIP_IMAGECTX_FITTOWIDTH, CTRUE
                  EXIT FUNCTION
               END IF
            CASE IDC_RADIO_FITTOHEIGHT
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  AfxCImageCtxPtr(hwnd, IDC_IMAGECTX)-&gt;SetImageAdjustment GDIP_IMAGECTX_FITTOHEIGHT, CTRUE
                  ' // Alternate way: Get a pointer to the CImageCtx class
'                  pImageCtx = CAST(CImageCtx PTR, GetWindowLongPtr(GetDlgItem(hwnd, IDC_IMAGECTX), 0))
'                  pImageCtx-&gt;SetImageAdjustment GDIP_IMAGECTX_FITTOHEIGHT, CTRUE
                  EXIT FUNCTION
               END IF
            CASE IDC_RADIO_STRETCH
               IF GET_WM_COMMAND_CMD(wParam, lParam) = BN_CLICKED THEN
                  AfxCImageCtxPtr(hwnd, IDC_IMAGECTX)-&gt;SetImageAdjustment GDIP_IMAGECTX_STRETCH, CTRUE
                  ' // Alternate way: Get a pointer to the CImageCtx class
'                  pImageCtx = CAST(CImageCtx PTR, GetWindowLongPtr(GetDlgItem(hwnd, IDC_IMAGECTX), 0))
'                  pImageCtx-&gt;SetImageAdjustment GDIP_IMAGECTX_STRETCH, CTRUE
                  EXIT FUNCTION
               END IF
         END SELECT

      CASE WM_NOTIFY
         ' // Process notification messages
         DIM phdr AS NMHDR PTR
         phdr = cast(NMHDR PTR, lParam)
         IF wParam = IDC_IMAGECTX THEN
            SELECT CASE phdr-&gt;code
               CASE NM_CLICK : MessageBox hwnd, &quot;NM_CLICK&quot;, &quot;&quot;, MB_OK
               CASE NM_DBLCLK
               CASE NM_RCLICK
               CASE NM_RDBLCLK
               CASE NM_SETFOCUS
               CASE NM_KILLFOCUS
            END SELECT
         END IF

      CASE WM_SIZE
         pWindow = AfxCWindowPtr(hwnd)
         ' // Alternate way:
'         pWindow = CAST(CWindow PTR, GetWindowLongPtr(hwnd, 0))
         ' // If the window isn't minimized, resize it
         IF wParam &lt;&gt; SIZE_MINIMIZED THEN
            pWindow-&gt;MoveWindow GetDlgItem(hwnd, IDC_IMAGECTX), 10, 10, pWindow-&gt;ClientWidth - 20, pWindow-&gt;ClientHeight - 65, CTRUE
            pWindow-&gt;MoveWindow GetDlgItem(hwnd, IDC_LOAD), pWindow-&gt;ClientWidth - 185, pWindow-&gt;ClientHeight - 35, 75, 23, CTRUE
            pWindow-&gt;MoveWindow GetDlgItem(hwnd, IDCANCEL), pWindow-&gt;ClientWidth - 95, pWindow-&gt;ClientHeight - 35, 75, 23, CTRUE
            pWindow-&gt;MoveWindow GetDlgItem(hwnd, IDC_RADIO_AUTOSIZE), 15, pWindow-&gt;ClientHeight - 49, 100, 21, CTRUE
            pWindow-&gt;MoveWindow GetDlgItem(hwnd, IDC_RADIO_ACTUALSIZE), 15, pWindow-&gt;ClientHeight - 28, 100, 21, CTRUE
            pWindow-&gt;MoveWindow GetDlgItem(hwnd, IDC_RADIO_FITTOWIDTH), 150, pWindow-&gt;ClientHeight - 49, 100, 21, CTRUE
            pWindow-&gt;MoveWindow GetDlgItem(hwnd, IDC_RADIO_FITTOHEIGHT), 150, pWindow-&gt;ClientHeight - 28, 100, 21, CTRUE
            pWindow-&gt;MoveWindow GetDlgItem(hwnd, IDC_RADIO_STRETCH), 275, pWindow-&gt;ClientHeight - 28, 60, 21, CTRUE
         END IF

        CASE WM_DESTROY
         ' // Ends the application by sending a WM_QUIT message
         PostQuitMessage(0)
         EXIT FUNCTION

   END SELECT

   ' // Default processing of Windows messages
   FUNCTION = DefWindowProcW(hWnd, uMsg, wParam, lParam)

END FUNCTION
' ========================================================================================
</code></pre>
</body>
</html>

