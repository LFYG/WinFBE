<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta http-equiv='X-UA-Compatible' content='IE=edge' />
  <meta http-equiv='MSThemeCompatible' content='Yes'>

  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>CDSAudio Class</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">@font-face {font-family: octicons-link;src: url(data:font/woff;charset=utf-8;base64,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) format('woff');}body {-webkit-text-size-adjust: 100%;text-size-adjust: 100%;color: #333;font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";font-size: 16px;line-height: 1.6;word-wrap: break-word;width: 728px;max-width: 99%;box-sizing: border-box;padding: 30px 30px 8rem 30px;margin-left: auto;margin-right: auto;}body a {background-color: transparent;}body a:active,body a:hover {outline: 0;}body strong {font-weight: bold;}body h1 {font-size: 2em;margin: 0.67em 0;}body img {border: 0;}body hr {box-sizing: content-box;height: 0;}body pre {overflow: auto;}body code,body kbd,body pre {font-family: monospace, monospace;font-size: 1em;}body input {color: inherit;font: inherit;margin: 0;}body html input[disabled] {cursor: default;}body input {line-height: normal;}body input[type="checkbox"] {box-sizing: border-box;padding: 0;}body table {border-collapse: collapse;border-spacing: 0;}body td,body th {padding: 0;}body * {box-sizing: border-box;}body input {font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";}body a {color: #4078c0;text-decoration: none;}body a:hover,body a:active {text-decoration: underline;}body hr {height: 0;margin: 15px 0;overflow: hidden;background: transparent;border: 0;border-bottom: 1px solid #ddd;}body hr:before {display: table;content: "";}body hr:after {display: table;clear: both;content: "";}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 15px;margin-bottom: 15px;line-height: 1.1;}body h1 {font-size: 30px;}body h2 {font-size: 21px;}body h3 {font-size: 16px;}body h4 {font-size: 14px;}body h5 {font-size: 12px;}body h6 {font-size: 11px;}body blockquote {margin: 0;}body ul,body ol {padding: 0;margin-top: 0;margin-bottom: 0;}body ol ol,body ul ol {list-style-type: lower-roman;}body ul ul ol,body ul ol ol,body ol ul ol,body ol ol ol {list-style-type: lower-alpha;}body dd {margin-left: 0;}body code {font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;font-size: 12px;}body pre {margin-top: 0;margin-bottom: 0;font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;}body .select::-ms-expand {opacity: 0;}body .octicon {font: normal normal normal 16px/1 octicons-link;display: inline-block;text-decoration: none;text-rendering: auto;-webkit-font-smoothing: antialiased;-moz-osx-font-smoothing: grayscale;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}body .octicon-link:before {content: '\f05c';}body:before {display: table;content: "";}body:after {display: table;clear: both;content: "";}body>*:first-child {margin-top: 0 !important;}body>*:last-child {margin-bottom: 0 !important;}body a:not([href]) {color: inherit;text-decoration: none;}body .anchor {display: inline-block;padding-right: 2px;margin-left: -18px;}body .anchor:focus {outline: none;}body h1,body h2,body h3,body h4,body h5,body h6 {margin-top: 1em;margin-bottom: 16px;font-weight: bold;line-height: 1.4;}body h1 .octicon-link,body h2 .octicon-link,body h3 .octicon-link,body h4 .octicon-link,body h5 .octicon-link,body h6 .octicon-link {color: #000;vertical-align: middle;visibility: hidden;}body h1:hover .anchor,body h2:hover .anchor,body h3:hover .anchor,body h4:hover .anchor,body h5:hover .anchor,body h6:hover .anchor {text-decoration: none;}body h1:hover .anchor .octicon-link,body h2:hover .anchor .octicon-link,body h3:hover .anchor .octicon-link,body h4:hover .anchor .octicon-link,body h5:hover .anchor .octicon-link,body h6:hover .anchor .octicon-link {visibility: visible;}body h1 {padding-bottom: 0.3em;font-size: 1.75em;line-height: 1.2;}body h1 .anchor {line-height: 1;}body h2 {padding-bottom: 0.3em;font-size: 1.5em;line-height: 1.225;}body h2 .anchor {line-height: 1;}body h3 {font-size: 1.25em;line-height: 1.43;}body h3 .anchor {line-height: 1.2;}body h4 {font-size: 1em;}body h4 .anchor {line-height: 1.2;}body h5 {font-size: 1em;}body h5 .anchor {line-height: 1.1;}body h6 {font-size: 1em;color: #777;}body h6 .anchor {line-height: 1.1;}body p,body blockquote,body ul,body ol,body dl,body table,body pre {margin-top: 0;margin-bottom: 16px;}body hr {height: 4px;padding: 0;margin: 16px 0;background-color: #e7e7e7;border: 0 none;}body ul,body ol {padding-left: 2em;}body ul ul,body ul ol,body ol ol,body ol ul {margin-top: 0;margin-bottom: 0;}body li>p {margin-top: 16px;}body dl {padding: 0;}body dl dt {padding: 0;margin-top: 16px;font-size: 1em;font-style: italic;font-weight: bold;}body dl dd {padding: 0 16px;margin-bottom: 16px;}body blockquote {padding: 0 15px;color: #777;border-left: 4px solid #ddd;}body blockquote>:first-child {margin-top: 0;}body blockquote>:last-child {margin-bottom: 0;}body table {display: block;width: 100%;overflow: auto;word-break: normal;word-break: keep-all;}body table th {font-weight: bold;}body table th,body table td {padding: 6px 13px;border: 1px solid #ddd;}body table tr {background-color: #fff;border-top: 1px solid #ccc;}body table tr:nth-child(2n) {background-color: #f8f8f8;}body img {max-width: 100%;box-sizing: content-box;background-color: #fff;}body code {padding: 0;padding-top: 0;padding-bottom: 0;margin: 0;font-size: 85%;background-color: rgba(0,0,0,0.04);border-radius: 3px;}body code:before,body code:after {letter-spacing: -0.2em;content: "\00a0";}body pre>code {padding: 0;margin: 0;font-size: 100%;word-break: normal;white-space: pre;background: transparent;border: 0;}body .highlight {margin-bottom: 16px;}body .highlight pre,body pre {padding: 16px;overflow: auto;font-size: 85%;line-height: 1.45;background-color: #f7f7f7;border-radius: 3px;}body .highlight pre {margin-bottom: 0;word-break: normal;}body pre {word-wrap: normal;}body pre code {display: inline;max-width: initial;padding: 0;margin: 0;overflow: initial;line-height: inherit;word-wrap: normal;background-color: transparent;border: 0;}body pre code:before,body pre code:after {content: normal;}body kbd {display: inline-block;padding: 3px 5px;font-size: 11px;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .pl-c {color: #969896;}body .pl-c1,body .pl-s .pl-v {color: #0086b3;}body .pl-e,body .pl-en {color: #795da3;}body .pl-s .pl-s1,body .pl-smi {color: #333;}body .pl-ent {color: #63a35c;}body .pl-k {color: #a71d5d;}body .pl-pds,body .pl-s,body .pl-s .pl-pse .pl-s1,body .pl-sr,body .pl-sr .pl-cce,body .pl-sr .pl-sra,body .pl-sr .pl-sre {color: #183691;}body .pl-v {color: #ed6a43;}body .pl-id {color: #b52a1d;}body .pl-ii {background-color: #b52a1d;color: #f8f8f8;}body .pl-sr .pl-cce {color: #63a35c;font-weight: bold;}body .pl-ml {color: #693a17;}body .pl-mh,body .pl-mh .pl-en,body .pl-ms {color: #1d3e81;font-weight: bold;}body .pl-mq {color: #008080;}body .pl-mi {color: #333;font-style: italic;}body .pl-mb {color: #333;font-weight: bold;}body .pl-md {background-color: #ffecec;color: #bd2c00;}body .pl-mi1 {background-color: #eaffea;color: #55a532;}body .pl-mdr {color: #795da3;font-weight: bold;}body .pl-mo {color: #1d3e81;}body kbd {display: inline-block;padding: 3px 5px;font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;line-height: 10px;color: #555;vertical-align: middle;background-color: #fcfcfc;border: solid 1px #ccc;border-bottom-color: #bbb;border-radius: 3px;box-shadow: inset 0 -1px 0 #bbb;}body .task-list-item {list-style-type: none;}body .task-list-item+.task-list-item {margin-top: 3px;}body .task-list-item input {margin: 0 0.35em 0.25em -1.6em;vertical-align: middle;}body :checked+.radio-label {z-index: 1;position: relative;border-color: #4078c0;}</style>
  
    
  
</head>
<body>
<h1 id="cdsaudio-class">CDSAudio Class</h1>
<p>The <strong>CDSAudio</strong> class allows to play audio files of a variety of formats using <strong>Direct Show</strong>.</p>
<p><strong>Include file</strong>: CDSAudio.inc</p>
<h3 id="constructor">Constructor</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#Constructor">Constructor</a></td>
<td>Creates an instance of the <strong>CDSAudio</strong> class and loads the specified audio file.</td>
</tr>
</tbody>
</table>
<h3 id="methods">Methods</h3>
<table>
<thead>
<tr class="header">
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#GetBalance">GetBalance</a></td>
<td>Gets the balance for the audio signal.</td>
</tr>
<tr class="even">
<td><a href="#CurrentPosition">CurrentPosition</a></td>
<td>Gets the current position, relative to the total duration of the stream.</td>
</tr>
<tr class="odd">
<td><a href="#GetDuration">GetDuration</a></td>
<td>Gets the duration of the stream, in 100-nanosecond units.</td>
</tr>
<tr class="even">
<td><a href="#GetEvent">GetEvent</a></td>
<td>Retrieves the next event notification from the event queue.</td>
</tr>
<tr class="odd">
<td><a href="#GetVolume">GetVolume</a></td>
<td>Gets the volume (amplitude) of the audio signal.</td>
</tr>
<tr class="even">
<td><a href="#Load">Load</a></td>
<td>Builds a filter graph that renders the specified file.</td>
</tr>
<tr class="odd">
<td><a href="#Pause">Pause</a></td>
<td>Pauses all the filters in the filter graph.</td>
</tr>
<tr class="even">
<td><a href="#Run">Run</a></td>
<td>Runs all the filters in the filter graph.</td>
</tr>
<tr class="odd">
<td><a href="#SetBalance">SetBalance</a></td>
<td>Sets the balance for the audio signal.</td>
</tr>
<tr class="even">
<td><a href="#SetNotifyWindow">SetNotifyWindow</a></td>
<td>Registers a window to process event notifications.</td>
</tr>
<tr class="odd">
<td><a href="#SetPositions">SetPositions</a></td>
<td>Sets the current position and the stop position.</td>
</tr>
<tr class="even">
<td><a href="#SetVolume">SetVolume</a></td>
<td>Sets the volume (amplitude) of the audio signal.</td>
</tr>
<tr class="odd">
<td><a href="#Stop">Stop</a></td>
<td>Stops all the filters in the filter graph.</td>
</tr>
<tr class="even">
<td><a href="#WaitForCompletion">WaitForCompletion</a></td>
<td>Waits for the filter graph to render all available data.</td>
</tr>
</tbody>
</table>
<h1 id="constructor-1"><a name="Constructor"></a>Constructor</h1>
<p>Creates an instance of the <strong>CDSAudio</strong> class and loads the specified audio file.</p>
<pre><code>CONSTRUCTOR CDSAudio (BYREF wszFileName AS WSTRING)
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>wszFilename</em></td>
<td>The file to load.</td>
</tr>
</tbody>
</table>
<p>You can create an instance of the class and load the file at the same time with:</p>
<pre><code>DIM pCDSAudio AS CDSAudio = &quot;MyAudioFile.mp3&quot;
</code></pre>
<p>or you can use the default constructor and then load the file:</p>
<pre><code>DIM pCDSAudio AS CDSAudio
pCDSAudio.Load(&quot;MyAudioFile.mp3&quot;)
</code></pre>
<p>With the <strong>Load</strong> method you can change the audio file on the fly.</p>
<p>To receive event messages, you can define a custom message</p>
<pre><code>#define WM_GRAPHNOTIFY  WM_APP + 1
</code></pre>
<p>and pass it to the <strong>SetNotifyWindow</strong> method, together with the handle of the window that will process the message:</p>
<pre><code>pCDSAudio.SetNotifyWindow(pWindow.hWindow, WM_GRAPHNOTIFY, 0)
</code></pre>
<p>The messages will be processed in the window callback procedure:</p>
<pre><code>      CASE WM_GRAPHNOTIFY
         DIM AS LONG lEventCode
         DIM AS LONG_PTR lParam1, lParam2
         WHILE (SUCCEEDED(pCDSAudio.GetEvent(lEventCode, lParam1, lParam2)))
            SELECT CASE lEventCode
               CASE EC_COMPLETE:    ' Handle event
               CASE EC_USERABORT:    ' Handle event
               CASE EC_ERRORABORT:   ' Handle event
            END SELECT
         WEND
</code></pre>
<p>Once loaded, you can start playing the audio file calling the <strong>Run</strong> method:</p>
<pre><code>pCDSAudio.Run
</code></pre>
<p>There are other methods to get/set the volume and balance, to get the duration and current position, to set the positions, and to pause or stop.</p>
<h1 id="getbalance"><a name="GetBalance"></a>GetBalance</h1>
<p>Gets the balance for the audio signal.</p>
<pre><code>FUNCTION GetBalance () AS LONG
</code></pre>
<h4 id="return-value">Return value</h4>
<p>The balance for the audio signal.</p>
<h4 id="remarks">Remarks</h4>
<p>The balance ranges from -10,000 to 10,000. The value -10,000 means the right channel is attenuated by 100 dB and is effectively silent. The value 10,000 means the left channel is silent. The neutral value is 0, which means that both channels are at full volume. When one channel is attenuated, the other remains at full volume.</p>
<h1 id="currentposition"><a name="CurrentPosition"></a>CurrentPosition</h1>
<p>Gets the current position, relative to the total duration of the stream.</p>
<pre><code>FUNCTION CurrentPosition () AS LONG
</code></pre>
<h1 id="getduration"><a name="GetDuration"></a>GetDuration</h1>
<p>Gets the duration of the stream, in 100-nanosecond units.</p>
<pre><code>FUNCTION GetDuration () AS LONG
</code></pre>
<h1 id="getevent"><a name="GetEvent"></a>GetEvent</h1>
<p>Retrieves the next event notification from the event queue.</p>
<pre><code>FUNCTION GetEvent(BYREF lEventCode AS LONG, BYREF lParam1 AS LONG_PTR, _
   BYREF lParam2 AS LONG_PTR, BYVAL msTimeout AS LONG = 0) AS HRESULT
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>lEventCode</em></td>
<td>Out. Variable that receives the event code.</td>
</tr>
<tr class="even">
<td><em>lParam1</em></td>
<td>Out. Variable that receives the first event parameter.</td>
</tr>
<tr class="odd">
<td><em>lParam2</em></td>
<td>Out. Variable that receives the second event parameter.</td>
</tr>
<tr class="even">
<td><em>msTimeout</em></td>
<td>In. Time-out interval, in milliseconds. Use INFINITE to block until there is an event.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th>Result code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S_OK</td>
<td>Success.</td>
</tr>
<tr class="even">
<td>E_ABORT</td>
<td>Timeout expired.</td>
</tr>
<tr class="odd">
<td>E_POINTER</td>
<td>The <strong>IMediaEventEx</strong> interface pointer is null.</td>
</tr>
</tbody>
</table>
<h1 id="getvolume"><a name="GetVolume"></a>GetVolume</h1>
<p>Gets the volume (amplitude) of the audio signal.</p>
<pre><code>FUNCTION GetVolume () AS LONG
</code></pre>
<h4 id="return-value-1">Return value</h4>
<p>The volume (amplitude) of the audio signal. Specifies the volume, as a number from –10,000 to 0, inclusive. Full volume is 0, and –10,000 is silence. Multiply the desired decibel level by 100. For example, –10,000 = –100 dB.</p>
<h1 id="load"><a name="Load"></a>Load</h1>
<p>Builds a filter graph that renders the specified file.</p>
<pre><code>FUNCTION Load (BYREF wszFileName AS WSTRING) AS HRESULT
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>wszFilename</em></td>
<td>The file to load.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-2">Return value</h4>
<table>
<thead>
<tr class="header">
<th>Result code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S_OK</td>
<td>Success.</td>
</tr>
<tr class="even">
<td>VFW_S_AUDIO_NOT_RENDERED</td>
<td>Partial success; the audio was not rendered.</td>
</tr>
<tr class="odd">
<td>VFW_S_DUPLICATE_NAME</td>
<td>Success; the Filter Graph Manager modified the filter name to avoid duplication.</td>
</tr>
<tr class="even">
<td>VFW_S_PARTIAL_RENDER</td>
<td>Some of the streams in this movie are in an unsupported format.</td>
</tr>
<tr class="odd">
<td>VFW_S_VIDEO_NOT_RENDERED</td>
<td>Partial success; some of the streams in this movie are in an unsupported format.</td>
</tr>
<tr class="even">
<td>E_ABORT</td>
<td>Operation aborted.</td>
</tr>
<tr class="odd">
<td>E_FAIL</td>
<td>Failure.</td>
</tr>
<tr class="even">
<td>E_INVALIDARG</td>
<td>Argument is invalid.</td>
</tr>
<tr class="odd">
<td>E_OUTOFMEMORY</td>
<td>Insufficient memory.</td>
</tr>
<tr class="even">
<td>E_POINTER</td>
<td>NULL pointer argument..</td>
</tr>
<tr class="odd">
<td>VFW_E_CANNOT_CONNECT</td>
<td>No combination of intermediate filters could be found to make the connection..</td>
</tr>
<tr class="even">
<td>VFW_E_CANNOT_LOAD_SOURCE_FILTER</td>
<td>The source filter for this file could not be loaded..</td>
</tr>
<tr class="odd">
<td>VFW_E_CANNOT_RENDER</td>
<td>No combination of filters could be found to render the stream..</td>
</tr>
<tr class="even">
<td>VFW_E_INVALID_FILE_FORMAT</td>
<td>The file format is invalid..</td>
</tr>
<tr class="odd">
<td>VFW_E_NOT_FOUND</td>
<td>An object or name was not found..</td>
</tr>
<tr class="even">
<td>VFW_E_UNKNOWN_FILE_TYPE</td>
<td>The media type of this file is not recognized..</td>
</tr>
<tr class="odd">
<td>VFW_E_UNSUPPORTED_STREAM</td>
<td>Cannot play back the file: the format is not supported..</td>
</tr>
</tbody>
</table>
<h1 id="pause"><a name="Pause"></a>Pause</h1>
<p>Pauses all the filters in the filter graph.</p>
<pre><code>FUNCTION Pause () AS HRESULT
</code></pre>
<h4 id="return-value-3">Return value</h4>
<table>
<thead>
<tr class="header">
<th>Result code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S_OK</td>
<td>All filters in the graph completed the transition to a paused state.</td>
</tr>
<tr class="even">
<td>S_FALSE</td>
<td>The graph paused successfully, but some filters have not completed the state transition.</td>
</tr>
<tr class="odd">
<td>E_POINTER</td>
<td>The <strong>IMediaControl</strong> interface pointer is null.</td>
</tr>
</tbody>
</table>
<h1 id="run"><a name="Run"></a>Run</h1>
<p>Runs all the filters in the filter graph.</p>
<pre><code>FUNCTION Run () AS HRESULT
</code></pre>
<h4 id="return-value-4">Return value</h4>
<table>
<thead>
<tr class="header">
<th>Result code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S_OK</td>
<td>All filters in the graph completed the transition to a running state.</td>
</tr>
<tr class="even">
<td>S_FALSE</td>
<td>The graph is preparing to run, but some filters have not completed the transition to a running state.</td>
</tr>
<tr class="odd">
<td>E_POINTER</td>
<td>The <strong>IMediaControl</strong> interface pointer is null.</td>
</tr>
</tbody>
</table>
<h1 id="setbalance"><a name="SetBalance"></a>SetBalance</h1>
<p>Sets the balance for the audio signal.</p>
<pre><code>FUNCTION SetBalance (BYVAL nBalance AS LONG) AS HRESULT
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nBalance</em></td>
<td>The balance ranges from -10,000 to 10,000. The value -10,000 means the right channel is attenuated by 100 dB and is effectively silent. The value 10,000 means the left channel is silent. The neutral value is 0, which means that both channels are at full volume. When one channel is attenuated, the other remains at full volume.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-5">Return value</h4>
<table>
<thead>
<tr class="header">
<th>Result code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S_OK</td>
<td>Success.</td>
</tr>
<tr class="even">
<td>E_FAIL</td>
<td>The underlying audio device returned an error.</td>
</tr>
<tr class="odd">
<td>E_INVALIDARG</td>
<td>The value of <em>nBalance</em> is invalid.</td>
</tr>
<tr class="even">
<td>E_NOTIMPL</td>
<td>The filter graph does not contain an audio renderer filter. (Possibly the source does not contain an audio stream.)</td>
</tr>
<tr class="odd">
<td>E_POINTER</td>
<td>The <strong>IBasicAudio</strong> interface pointer is null.</td>
</tr>
</tbody>
</table>
<h1 id="setnotifywindow"><a name="SetNotifyWindow"></a>SetNotifyWindow</h1>
<p>Sets the balance for the audio signal.</p>
<pre><code>FUNCTION SetNotifyWindow (BYVAL hwnd AS HWND, BYVAL lMsg AS LONG, BYVAL lParam AS LONG_PTR) AS HRESULT
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>hwnd</em></td>
<td>Handle to the window.</td>
</tr>
<tr class="even">
<td><em>lMsg</em></td>
<td>Window message to be passed as the notification.</td>
</tr>
<tr class="odd">
<td><em>lInstanceData</em></td>
<td>Value to be passed as the lParam parameter for the lMsg message.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-6">Return value</h4>
<p>Returns S_OK if successful or E_INVALIDARG if the hwnd parameter is not a valid handle to a window.</p>
<h1 id="setpositions"><a name="SetPositions"></a>SetPositions</h1>
<p>Sets the current position and the stop position.</p>
<pre><code>FUNCTION SetPositions (BYREF pCurrent AS LONGLONG, BYREF pStop AS LONGLONG, _
   BYVAL bAbsolutePositioning AS BOOLEAN) AS HRESULT
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>pCurrent</em></td>
<td>In/Out. Pointer to a variable that specifies the current position, in units of the current time format.</td>
</tr>
<tr class="even">
<td><em>pStop</em></td>
<td>In/Out. Pointer to a variable that specifies the stop time, in units of the current time format.</td>
</tr>
<tr class="odd">
<td><em>lInstanceData</em></td>
<td>In. TRUE or FALSE. If TRUE, the specified position is absolute. If FALSE, the specified position is relative.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-7">Return value</h4>
<table>
<thead>
<tr class="header">
<th>Result code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S_OK</td>
<td>Success.</td>
</tr>
<tr class="even">
<td>S_FALSE</td>
<td>No position change. (Both flags specify no seeking.)</td>
</tr>
<tr class="odd">
<td>E_INVALIDARG</td>
<td>Invalid argument.</td>
</tr>
<tr class="even">
<td>E_NOTIMPL</td>
<td>Method is not supported.</td>
</tr>
<tr class="odd">
<td>E_POINTER</td>
<td>NULL pointer argument.</td>
</tr>
</tbody>
</table>
<h1 id="setvolume"><a name="SetVolume"></a>SetVolume</h1>
<p>Sets the volume (amplitude) of the audio signal.</p>
<pre><code>FUNCTION SetVolume (BYVAL nVol AS LONG) AS HRESULT
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>nVol</em></td>
<td>The volume (amplitude) of the audio signal. Specifies the volume, as a number from –10,000 to 0, inclusive. Full volume is 0, and –10,000 is silence. Multiply the desired decibel level by 100. For example, –10,000 = –100 dB.</td>
</tr>
</tbody>
</table>
<h1 id="stop"><a name="Stop"></a>Stop</h1>
<p>Stops all the filters in the filter graph.</p>
<pre><code>FUNCTION Stop () AS HRESULT
</code></pre>
<h4 id="return-value-8">Return value</h4>
<p>Returns S_OK if successful, or an HRESULT value that indicates the cause of the error.</p>
<h1 id="waitforcompletion"><a name="WaitForCompletion"></a>WaitForCompletion</h1>
<p>Waits for the filter graph to render all available data.</p>
<pre><code>FUNCTION WaitForCompletion (BYVAL msTimeout AS LONG, BYREF EvCode AS LONG) AS HRESULT
</code></pre>
<table>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><em>msTimeout</em></td>
<td>Duration of the time-out, in milliseconds. Pass zero to return immediately. To block indefinitely, pass INFINITE.</td>
</tr>
<tr class="even">
<td><em>EvCode</em></td>
<td>Out. Event that terminated the wait. This value can be one of the following:<br><strong>EC_COMPLETE</strong> : Operation completed.<br><strong>EC_ERRORABORT</strong> : Error. Playback cannot continue.<br><strong>EC_USERABORT</strong> : User terminated the operation.<br><strong>Zero</strong> (0) = Operation has not completed.</td>
</tr>
</tbody>
</table>
<h4 id="return-value-9">Return value</h4>
<table>
<thead>
<tr class="header">
<th>Result code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>S_OK</td>
<td>Success.</td>
</tr>
<tr class="even">
<td>E_ABORT</td>
<td>Time-out expired.</td>
</tr>
<tr class="odd">
<td>E_POINTER</td>
<td>The <strong>IMediaEventEx</strong> interface is null.</td>
</tr>
<tr class="even">
<td>VFW_E_WRONG_STATE</td>
<td>The filter graph is not running.</td>
</tr>
</tbody>
</table>
<h4 id="remarks-1">Remarks</h4>
<p>This method blocks until the time-out expires, or one of the following events occurs:</p>
<p><strong>EC_COMPLETE</strong><br> <strong>EC_ERRORABORT</strong><br> <strong>EC_USERABORT</strong></p>
<p>During the wait, the method discards all other event notifications.</p>
<p>If the return value is S_OK, the <em>EvCode</em> parameter receives the event code that ended the wait. When the method returns, the filter graph is still running. The application can pause or stop the graph, as appropriate.</p>
</body>
</html>

